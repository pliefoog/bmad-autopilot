name: "Comprehensive Coastal Sailing Scenario"
description: "Complete coastal cruiser simulation with realistic Tri-Data/multisensor output matching NMEA 2000→0183 bridge behavior (DPT depth with offset, VHW speed, MTW water temp) plus full marine systems. Works with both NMEA 0183 and NMEA 2000 protocols. Includes depth, speed (STW/SOG), wind, GPS, compass, engine, batteries (2x), tanks (4x), temperatures, and rudder position. Mimics Raymarine/B&G/Airmar transducer bridged to NMEA 0183."
duration: 600  # 10 minutes
version: "2.0"
category: "navigation"
bridge_mode: "nmea0183"  # Can be: nmea0183 | nmea2000 | hybrid

# Generator parameters (required by schema for NMEA 0183 sentence generation)
parameters:
  vessel:
    keel_offset: 1.8              # meters below transducer (required - used in DPT/DBK offset field)
  sonar:
    max_range: 100.0              # meters (required - used in DPT max range field)
  gps:
    quality: 1                    # GPS fix quality (required - 0=invalid, 1=GPS fix, 2=DGPS)
    satellites: 8                 # Number of satellites (required - used in GGA sentence)
    hdop: 1.0                     # Horizontal dilution of precision (required - used in GGA sentence)
    altitude: 0.0                 # Altitude above MSL in meters (optional - used in GGA sentence)
  compass:
    magnetic_deviation: 0.0       # Magnetic deviation in degrees (required - used in HDG sentence)
    magnetic_variation: -15.0     # Magnetic variation in degrees (required - used in HDG sentence)
  autopilot:
    max_heading_rate: 10          # Maximum heading rate in degrees/second for smooth transitions
    cross_track_tolerance: 0.1    # Cross-track error tolerance in nautical miles
    arrival_radius: 0.2           # Waypoint arrival circle radius in nautical miles

# PROTOCOL-AGNOSTIC SENSOR DEFINITIONS
# Physical sensors with data generation and physical properties
# No NMEA 0183 or NMEA 2000 references - bridge code handles protocol mapping
sensors:
  # ========== DEPTH SENSOR ==========
  - type: depth_sensor
    instance: 0
    name: "Primary Depth Sounder"
    update_rate: 2  # Hz
    physical_properties:
      transducer_depth: 1.8        # meters below waterline (maps to DPT offset or PGN 128267 byte[8])
      keel_offset: 0.5              # meters below transducer (for DBK calculation)
      max_range: 100.0              # meters
      mounting_location: "bow"
    data_generation:
      depth:
        type: "sawtooth"            # Sawtooth pattern for testing trendline visualization
        min: 1.5                    # meters - shallow water
        max: 6.0                    # meters - deeper water
        period: 60                  # 60 seconds - one full cycle per minute
        phase: 0                    # Start at minimum depth

  # ========== SPEED THROUGH WATER SENSOR (STW) ==========
  # Paddlewheel/log sensor measuring speed relative to water mass
  - type: speed_sensor
    instance: 0
    name: "Paddle Wheel Speed Log (STW)"
    update_rate: 1  # Hz
    physical_properties:
      speed_type: "STW"
      unit: "knots"
      precision: 0.1
    data_generation:
      speed:
        type: "sine_wave"           # Sine wave for smooth speed variation
        base: 4.5                   # Average speed: 4.5 knots
        amplitude: 1.2              # ±1.2 knots variation (3.3-5.7 knots)
        period: 120                 # 2-minute cycle for wave motion effects
        min: 2.5
        max: 6.5

  # NOTE: SOG (Speed Over Ground) comes from GPS sensor via VTG sentence
  # No separate "SOG sensor" needed - GPS calculates speed from position changes

  # ========== WIND SENSOR ==========
  - type: wind_sensor
    instance: 0
    name: "Masthead Wind Instrument"
    update_rate: 2  # Hz
    physical_properties:
      sensor_height: 12.5           # meters above deck (maps to PGN 130306 byte[6])
      mounting_location: "masthead"
      reference_type: "apparent"    # Maps to MWV.reference or PGN 130306 byte[5]
    data_generation:
      wind_speed:
        type: "sine_wave"
        base: 14                    # knots
        amplitude: 4                # ±4 knots thermal variation
        period: 300                 # 5-minute cycles
        min: 8
        max: 22
        noise:
          type: "gaussian"
          std_dev: 0.5              # Gust effect
      wind_angle:
        type: "sine_wave"
        base: 120                   # degrees
        amplitude: 30               # ±30 degrees thermal shift
        period: 300                 # 5-minute cycles

  # ========== GPS SENSOR ==========
  - type: gps_sensor
    instance: 0
    name: "Primary GPS Antenna"
    update_rate: 1  # Hz (RMC), 5 Hz (GGA fast updates)
    physical_properties:
      antenna_height: 3.2           # meters above water
      horizontal_accuracy: 2.5      # meters (maps to GGA.hdop or PGN 129025)
      mounting_location: "stern_arch"
    data_generation:
      position:
        type: "gps_track"           # GPS track with waypoint interpolation
        start_position:
          latitude: 41.4800         # Lake Erie coastal area
          longitude: -81.6900
        track_type: "coastal_navigation"
        waypoints:
          - latitude: 41.4800
            longitude: -81.6900
            time: 0      # Start (Cleveland Harbor)
          - latitude: 41.4850
            longitude: -81.6800
            time: 150    # 2.5 min - heading ~52° NE
          - latitude: 41.4900
            longitude: -81.6750
            time: 300    # 5 min - heading ~56° NE
          - latitude: 41.4950
            longitude: -81.6700
            time: 450    # 7.5 min - heading ~56° NE
          - latitude: 41.5000
            longitude: -81.6650
            time: 600    # 10 min end - heading ~56° NE

  # ========== HEADING SENSOR ==========
  - type: heading_sensor
    instance: 0
    name: "Fluxgate Compass"
    update_rate: 5  # Hz
    physical_properties:
      reference: "magnetic"
      deviation: 0.0                # degrees (maps to HDG.deviation or PGN 127250 byte[4-5])
      variation: -15.0              # degrees west (maps to HDG.variation or PGN 127250 byte[6-7])
      precision: 0.5
    data_generation:
      heading:
        type: "gps_track"           # Calculate heading from GPS waypoints (great circle bearing)
        source: "gps_track"         # Uses GPS waypoints for heading calculation
        smooth_transitions: true    # Enable 10°/s rate limiting for realistic heading changes

  # ========== TEMPERATURE SENSORS (5x) ==========
  # Multiple temperature monitoring points
  
  # Seawater Temperature (from through-hull sensor)
  - type: temperature_sensor
    instance: 0
    name: "Seawater Temperature"
    update_rate: 0.2  # Hz (every 5 seconds)
    physical_properties:
      sensor_type: "water"
      location: "SEAW"
      location_name: "Seawater"
      unit: "celsius"
      precision: 0.1
    data_generation:
      temperature:
        type: "gaussian"
        mean: 18.5                  # °C
        std_dev: 0.5
        min: 16.0
        max: 22.0

  # Outside Air Temperature (from mast sensor)
  - type: temperature_sensor
    instance: 1
    name: "Outside Air Temperature"
    update_rate: 0.2  # Hz (every 5 seconds)
    physical_properties:
      sensor_type: "air"
      location: "AIRX"
      location_name: "Outside Air"
      unit: "celsius"
      precision: 0.1
    data_generation:
      temperature:
        type: "sine_wave"
        base: 22.0                  # °C
        amplitude: 4.0              # ±4°C
        period: 600                 # 10-minute thermal cycle
        min: 15.0
        max: 28.0

  # Engine Room Temperature (from bilge sensor)
  - type: temperature_sensor
    instance: 2
    name: "Engine Room Temperature"
    update_rate: 0.2  # Hz (every 5 seconds)
    physical_properties:
      sensor_type: "engine"
      location: "ENGR"
      location_name: "Engine Room"
      unit: "celsius"
      precision: 0.5
    data_generation:
      temperature:
        type: "gaussian"
        mean: 35.0                  # °C (hot engine room)
        std_dev: 3.0
        min: 25.0
        max: 50.0

  # Main Cabin Temperature (from salon sensor)
  - type: temperature_sensor
    instance: 3
    name: "Main Cabin Temperature"
    update_rate: 0.2  # Hz (every 5 seconds)
    physical_properties:
      sensor_type: "cabin"
      location: "TEMP"
      location_name: "Main Cabin"
      unit: "celsius"
      precision: 0.1
    data_generation:
      temperature:
        type: "gaussian"
        mean: 21.0                  # °C (comfortable cabin)
        std_dev: 1.5
        min: 18.0
        max: 26.0

  # Refrigerator Temperature (from fridge sensor)
  - type: temperature_sensor
    instance: 4
    name: "Refrigerator Temperature"
    update_rate: 0.2  # Hz (every 5 seconds)
    physical_properties:
      sensor_type: "refrigeration"
      location: "TEMP"
      location_name: "Refrigerator"
      unit: "celsius"
      precision: 0.5
    data_generation:
      temperature:
        type: "sawtooth"            # Linear cooling cycle with compressor restart
        min: 2.0                    # Compressor turns on
        max: 8.0                    # Compressor turns off
        period: 120                 # 2-minute cooling cycle

  # ========== ATMOSPHERIC PRESSURE SENSOR ==========
  - type: atmospheric_pressure_sensor
    instance: 0
    name: "Main Weather Station"
    update_rate: 1  # Hz (every second for responsive trending)
    physical_properties:
      sensor_type: "barometric"
      location: "atmospheric"
      unit: "millibars"
      precision: 0.1
    data_generation:
      pressure:
        type: "sawtooth"            # Sawtooth pattern for testing
        min: 930                    # millibars - low pressure system
        max: 1030                   # millibars - high pressure system
        period: 60                  # 60 seconds - one full cycle per minute
        phase: 0                    # Start at minimum pressure
      
      # Air temperature (outside ambient temperature) - faster variation for testing
      temperature:
        type: "sine"                # Smooth temperature variation
        min: 18.0                   # °C - cooler temperature
        max: 28.0                   # °C - warmer temperature
        period: 300                 # 5-minute cycle for visible trending
        phase: 180                  # Start at mid-range (around 23°C)
      
      # Relative humidity (inversely correlated with temperature)
      humidity:
        type: "sine"                # Smooth humidity variation
        min: 50.0                   # % - lower humidity during warm periods
        max: 80.0                   # % - higher humidity during cool periods
        period: 300                 # 5-minute cycle (matches temperature)
        phase: 0                    # Start at maximum (peaks when temp is lowest)

  # ========== ENGINE SENSOR ==========
  - type: engine_sensor
    instance: 0
    name: "Main Diesel Engine"
    update_rate: 1  # Hz
    physical_properties:
      engine_instance: 0            # 0=port/single, 1=starboard (maps to RPM.source or PGN 127488 byte[0])
      rpm_calibration: 1.02         # RPM multiplier
      reduction_ratio: 2.5          # Engine:Shaft reduction gear ratio (2.5:1)
      sensor_types: ["rpm", "shaft_rpm", "coolant_temp", "oil_pressure", "alternator_voltage", "fuel_rate", "engine_hours"]
    data_generation:
      rpm:
        type: "sine_wave"
        base: 1800                  # RPM
        amplitude: 200              # ±200 RPM
        period: 120                 # 2-minute cycle
        min: 500
        max: 3200
      shaft_rpm:
        type: "calculated"          # Calculated from engine RPM / reduction_ratio
        source: "rpm"               # Takes value from rpm field
        divisor: 2.5                # Divide by reduction ratio
      coolant_temp:
        type: "sine_wave"
        base: 180.0                 # °F (82°C typical diesel operating temp)
        amplitude: 5.0              # ±5°F variation
        period: 180                 # 3-minute cycle
        min: 170.0
        max: 195.0
      oil_pressure:
        type: "sine_wave"
        base: 45.0                  # PSI (3.1 bar)
        amplitude: 2.0              # ±2 PSI variation
        period: 150                 # 2.5-minute cycle
        min: 35.0
        max: 55.0
      alternator_voltage:
        type: "sine_wave"
        base: 13.8                  # V (charging voltage)
        amplitude: 0.2              # ±0.2V variation
        period: 90                  # 1.5-minute cycle
        min: 13.4
        max: 14.2
      fuel_rate:
        type: "sine_wave"
        base: 3.5                   # L/h (gallons/hour converted)
        amplitude: 1.0              # ±1 L/h variation
        period: 120                 # 2-minute cycle
        min: 1.5
        max: 6.0
      engine_hours:
        type: "linear"
        start: 1247.5                # Starting hours
        rate: 0.0167                 # Hours per second (1 hour per 60 seconds at 1Hz = 1hr/min realtime)
        min: 0
        max: 9999.9

  # ========== BATTERY SENSORS (2x) ==========
  - type: battery_sensor
    instance: 0
    name: "House Battery Bank"
    update_rate: 0.5  # Hz (every 2 seconds)
    physical_properties:
      battery_instance: 0           # Maps to XDR.transducer_name (0183) or PGN 127508 byte[0] (2000)
      nominal_voltage: 12           # V
      capacity: 400                 # Ah
      chemistry: "AGM"              # Battery chemistry: FLA (Flooded Lead-Acid), AGM (Absorbed Glass Mat), GEL, LiFePO4
      xdr_format: "individual"      # XDR format: "compound" (single sentence, all params) or "individual" (separate sentences per param) - changed to individual for NKE Display Pro compatibility
    data_generation:
      voltage:
        type: "sine_wave"
        base: 12.6                  # V
        amplitude: 0.4              # ±0.4V
        period: 300
        min: 11.8
        max: 14.4
      current:
        type: "gaussian"
        mean: -15.0                 # A (negative = discharging)
        std_dev: 5.0
        min: -40.0
        max: 20.0
      temperature:
        type: "gaussian"
        mean: 298.15                # K (25°C)
        std_dev: 2.0
        min: 288.15
        max: 308.15

  - type: battery_sensor
    instance: 1
    name: "Starter Battery"
    update_rate: 0.5  # Hz
    physical_properties:
      battery_instance: 1
      nominal_voltage: 12
      capacity: 100
      chemistry: "FLA"              # Battery chemistry
      xdr_format: "individual"      # XDR format - changed to individual for NKE Display Pro compatibility
    data_generation:
      voltage:
        type: "gaussian"
        mean: 14.2                  # V (charging)
        std_dev: 0.2
        min: 12.0
        max: 14.8
      current:
        type: "gaussian"
        mean: 8.0                   # A (charging)
        std_dev: 2.0
        min: -10.0
        max: 30.0
      temperature:
        type: "gaussian"
        mean: 298.15
        std_dev: 1.5
        min: 290.15
        max: 305.15

  # ========== TANK SENSORS (4x) ==========
  - type: tank_sensor
    instance: 0
    name: "Fuel Tank - Starboard"
    update_rate: 0.4  # Hz (2.5 seconds - NMEA 2000 PGN 127505 standard)
    physical_properties:
      tank_type: "fuel"
      tank_capacity: 150
      unit: "percent"
      precision: 1
    data_generation:
      level:
        type: "linear"
        start: 85.0                 # % full
        end: 82.0                   # % full (3% decline over scenario)
        min: 0
        max: 100

  - type: tank_sensor
    instance: 1
    name: "Fuel Tank - Port"
    update_rate: 0.4  # Hz (2.5 seconds - NMEA 2000 standard)
    physical_properties:
      tank_type: "fuel"
      tank_capacity: 150
      unit: "percent"
      precision: 1
    data_generation:
      level:
        type: "linear"
        start: 82.0
        end: 79.0
        min: 0
        max: 100

  - type: tank_sensor
    instance: 2
    name: "Fresh Water Tank"
    update_rate: 0.4  # Hz (2.5 seconds - NMEA 2000 standard)
    physical_properties:
      tank_type: "fresh_water"
      tank_capacity: 200
      unit: "percent"
      precision: 1
    data_generation:
      level:
        type: "gaussian"
        mean: 65.0
        std_dev: 2.0
        min: 60.0
        max: 70.0

  - type: tank_sensor
    instance: 3
    name: "Gray Water Tank"
    update_rate: 0.4  # Hz (2.5 seconds - NMEA 2000 standard)
    physical_properties:
      tank_type: "gray_water"
      tank_capacity: 80
      unit: "percent"
      precision: 1
    data_generation:
      level:
        type: "linear"
        start: 15.0
        end: 20.0
        min: 0
        max: 100

  # ========== RUDDER SENSOR ==========
  - type: rudder_sensor
    instance: 0
    name: "Rudder Position Sensor"
    update_rate: 2  # Hz
    physical_properties:
      rudder_instance: 0            # 0=main rudder (maps to RSA.position or PGN 127245 byte[0])
      max_angle: 35                 # degrees
      calibration_offset: 0.5       # degrees (zero position adjustment)
    data_generation:
      angle:
        type: "sine_wave"
        base: 0                     # degrees (centered)
        amplitude: 8                # ±8 degrees
        period: 45                  # 45-second steering cycle
        min: -35
        max: 35

# IMPLEMENTATION NOTES:
# ======================
# 1. The bridge code (scenario.js) reads this sensors: array
# 2. For each sensor, it looks up the sensor type in SENSOR_TYPE_REGISTRY
# 3. Based on bridge_mode (nmea0183/nmea2000/hybrid), it routes to appropriate generators
# 4. Physical properties are mapped to protocol-specific fields:
#    - transducer_depth → DPT.offset (0183) or PGN 128267 byte[8] (2000)
#    - reference_type → MWV.reference (0183) or PGN 130306 byte[5] (2000)
#    - fluid_type → none (0183) or PGN 127505 byte[1] (2000)
# 5. Data generation remains protocol-agnostic - same tidal_cycle works for both DBT and PGN 128267
