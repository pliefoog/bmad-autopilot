{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.evaluateAlarm = evaluateAlarm;\n  /**\n   * Alarm Evaluation - Pure alarm state evaluation function\n   *\n   * Implements priority-based alarm evaluation:\n   * 1. Stale check FIRST - if data too old, stop (can't trust it)\n   * 2. Critical threshold check\n   * 3. Warning threshold check with hysteresis\n   */\n\n  /**\n   * Evaluates alarm state for a metric with priority-based logic\n   *\n   * Priority order:\n   * 1. Stale check (if data too old, stop - can't trust it)\n   * 2. Critical threshold check\n   * 3. Warning threshold check\n   *\n   * @param value - Current SI value\n   * @param timestamp - Value timestamp\n   * @param thresholds - Configured thresholds (optional)\n   * @param previousState - Previous alarm state (for hysteresis)\n   * @param staleThresholdMs - Time after which data is considered stale\n   * @returns Alarm level: 0 (none), 1 (stale), 2 (warning), 3 (critical)\n   */\n  function evaluateAlarm(value, timestamp, thresholds, previousState, staleThresholdMs) {\n    // Priority 1: Check stale FIRST - if stale, stop here\n    // Can't trust old data for threshold evaluation\n    if (Date.now() - timestamp > staleThresholdMs) {\n      return 1; // STALE\n    }\n\n    // If no thresholds configured, data is fresh and valid\n    if (!thresholds) {\n      return 0; // NONE\n    }\n\n    // Priority 2: Check critical thresholds\n    if (thresholds.critical.min !== undefined && value <= thresholds.critical.min || thresholds.critical.max !== undefined && value >= thresholds.critical.max) {\n      return 3; // CRITICAL\n    }\n\n    // Priority 3: Check warning thresholds with hysteresis\n    var isCurrentlyInWarning = previousState === 2;\n    var hysteresis = thresholds.hysteresis ?? 0.1;\n    var warningMinWithHysteresis = thresholds.warning.min !== undefined ? thresholds.warning.min * (1 + (isCurrentlyInWarning ? hysteresis : 0)) : undefined;\n    var warningMaxWithHysteresis = thresholds.warning.max !== undefined ? thresholds.warning.max * (1 - (isCurrentlyInWarning ? hysteresis : 0)) : undefined;\n    if (warningMinWithHysteresis !== undefined && value <= warningMinWithHysteresis || warningMaxWithHysteresis !== undefined && value >= warningMaxWithHysteresis) {\n      return 2; // WARNING\n    }\n    return 0; // NONE\n  }\n});","lineCount":57,"map":[[6,2,1,0],[7,0,2,0],[8,0,3,0],[9,0,4,0],[10,0,5,0],[11,0,6,0],[12,0,7,0],[13,0,8,0],[15,2,12,0],[16,0,13,0],[17,0,14,0],[18,0,15,0],[19,0,16,0],[20,0,17,0],[21,0,18,0],[22,0,19,0],[23,0,20,0],[24,0,21,0],[25,0,22,0],[26,0,23,0],[27,0,24,0],[28,0,25,0],[29,0,26,0],[30,2,27,7],[30,11,27,16,"evaluateAlarm"],[30,24,27,29,"evaluateAlarm"],[30,25,28,2,"value"],[30,30,28,15],[30,32,29,2,"timestamp"],[30,41,29,19],[30,43,30,2,"thresholds"],[30,53,30,42],[30,55,31,2,"previousState"],[30,68,31,30],[30,70,32,2,"staleThresholdMs"],[30,86,32,26],[30,88,33,17],[31,4,34,2],[32,4,35,2],[33,4,36,2],[33,8,36,6,"Date"],[33,12,36,10],[33,13,36,11,"now"],[33,16,36,14],[33,17,36,15],[33,18,36,16],[33,21,36,19,"timestamp"],[33,30,36,28],[33,33,36,31,"staleThresholdMs"],[33,49,36,47],[33,51,36,49],[34,6,37,4],[34,13,37,11],[34,14,37,12],[34,15,37,13],[34,16,37,14],[35,4,38,2],[37,4,40,2],[38,4,41,2],[38,8,41,6],[38,9,41,7,"thresholds"],[38,19,41,17],[38,21,41,19],[39,6,42,4],[39,13,42,11],[39,14,42,12],[39,15,42,13],[39,16,42,14],[40,4,43,2],[42,4,45,2],[43,4,46,2],[43,8,47,5,"thresholds"],[43,18,47,15],[43,19,47,16,"critical"],[43,27,47,24],[43,28,47,25,"min"],[43,31,47,28],[43,36,47,33,"undefined"],[43,45,47,42],[43,49,47,46,"value"],[43,54,47,51],[43,58,47,55,"thresholds"],[43,68,47,65],[43,69,47,66,"critical"],[43,77,47,74],[43,78,47,75,"min"],[43,81,47,78],[43,85,48,5,"thresholds"],[43,95,48,15],[43,96,48,16,"critical"],[43,104,48,24],[43,105,48,25,"max"],[43,108,48,28],[43,113,48,33,"undefined"],[43,122,48,42],[43,126,48,46,"value"],[43,131,48,51],[43,135,48,55,"thresholds"],[43,145,48,65],[43,146,48,66,"critical"],[43,154,48,74],[43,155,48,75,"max"],[43,158,48,79],[43,160,49,4],[44,6,50,4],[44,13,50,11],[44,14,50,12],[44,15,50,13],[44,16,50,14],[45,4,51,2],[47,4,53,2],[48,4,54,2],[48,8,54,8,"isCurrentlyInWarning"],[48,28,54,28],[48,31,54,31,"previousState"],[48,44,54,44],[48,49,54,49],[48,50,54,50],[49,4,55,2],[49,8,55,8,"hysteresis"],[49,18,55,18],[49,21,55,21,"thresholds"],[49,31,55,31],[49,32,55,32,"hysteresis"],[49,42,55,42],[49,46,55,46],[49,49,55,49],[50,4,57,2],[50,8,57,8,"warningMinWithHysteresis"],[50,32,57,32],[50,35,58,4,"thresholds"],[50,45,58,14],[50,46,58,15,"warning"],[50,53,58,22],[50,54,58,23,"min"],[50,57,58,26],[50,62,58,31,"undefined"],[50,71,58,40],[50,74,59,8,"thresholds"],[50,84,59,18],[50,85,59,19,"warning"],[50,92,59,26],[50,93,59,27,"min"],[50,96,59,30],[50,100,59,34],[50,101,59,35],[50,105,59,39,"isCurrentlyInWarning"],[50,125,59,59],[50,128,59,62,"hysteresis"],[50,138,59,72],[50,141,59,75],[50,142,59,76],[50,143,59,77],[50,144,59,78],[50,147,60,8,"undefined"],[50,156,60,17],[51,4,62,2],[51,8,62,8,"warningMaxWithHysteresis"],[51,32,62,32],[51,35,63,4,"thresholds"],[51,45,63,14],[51,46,63,15,"warning"],[51,53,63,22],[51,54,63,23,"max"],[51,57,63,26],[51,62,63,31,"undefined"],[51,71,63,40],[51,74,64,8,"thresholds"],[51,84,64,18],[51,85,64,19,"warning"],[51,92,64,26],[51,93,64,27,"max"],[51,96,64,30],[51,100,64,34],[51,101,64,35],[51,105,64,39,"isCurrentlyInWarning"],[51,125,64,59],[51,128,64,62,"hysteresis"],[51,138,64,72],[51,141,64,75],[51,142,64,76],[51,143,64,77],[51,144,64,78],[51,147,65,8,"undefined"],[51,156,65,17],[52,4,67,2],[52,8,68,5,"warningMinWithHysteresis"],[52,32,68,29],[52,37,68,34,"undefined"],[52,46,68,43],[52,50,68,47,"value"],[52,55,68,52],[52,59,68,56,"warningMinWithHysteresis"],[52,83,68,80],[52,87,69,5,"warningMaxWithHysteresis"],[52,111,69,29],[52,116,69,34,"undefined"],[52,125,69,43],[52,129,69,47,"value"],[52,134,69,52],[52,138,69,56,"warningMaxWithHysteresis"],[52,162,69,81],[52,164,70,4],[53,6,71,4],[53,13,71,11],[53,14,71,12],[53,15,71,13],[53,16,71,14],[54,4,72,2],[55,4,74,2],[55,11,74,9],[55,12,74,10],[55,13,74,11],[55,14,74,12],[56,2,75,0],[57,0,75,1],[57,3]],"functionMap":{"names":["<global>","evaluateAlarm"],"mappings":"AAA;OC0B;CDgD"}},"type":"js/module"}]}