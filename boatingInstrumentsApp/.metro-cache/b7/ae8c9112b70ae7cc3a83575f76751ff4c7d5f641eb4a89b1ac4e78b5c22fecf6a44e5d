{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"],"imports":1}},{"name":"./EventManager","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":59},"end":{"line":4,"column":42,"index":101}}],"key":"+tTRfUGWY5rcrw6ZVLEgvlFTMQc=","exportNames":["*"],"imports":1}},{"name":"../interfaces","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":43,"index":58}},{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":43,"index":58}},{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":43,"index":58}},{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":43,"index":58}},{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":43,"index":58}},{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":43,"index":58}}],"key":"GMKh3a5g5xNaAog15vl07v6pG2U=","exportNames":["*"],"imports":6}},{"name":"../../PointerType","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":102},"end":{"line":5,"column":48,"index":150}}],"key":"PNpP2j+zRZwLQ3w6ZmXPMJNakiU=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n  var _EventManager = _interopRequireDefault(require(_dependencyMap[1], \"./EventManager\"));\n  class KeyboardEventManager extends _EventManager.default {\n    static activationKeys = ['Enter', ' '];\n    static cancelationKeys = ['Tab'];\n    isPressed = false;\n    static registeredStaticListeners = false;\n    static instances = new Set();\n    static keyUpStaticCallback = event => {\n      // We need a global listener, as in some cases, keyUp event gets stop-propagated.\n      // Then, if we used only component-level listeners the gesture would never end,\n      // causing other gestues to fail.\n\n      if (this.activationKeys.indexOf(event.key) === -1) {\n        return;\n      }\n      this.instances.forEach(item => {\n        item.onKeyUp(event);\n      });\n    };\n    keyDownCallback = event => {\n      if (KeyboardEventManager.cancelationKeys.indexOf(event.key) !== -1 && this.isPressed) {\n        this.dispatchEvent(event, require(_dependencyMap[2], \"../interfaces\").EventTypes.CANCEL);\n        return;\n      }\n      if (KeyboardEventManager.activationKeys.indexOf(event.key) === -1) {\n        return;\n      }\n      this.dispatchEvent(event, require(_dependencyMap[2], \"../interfaces\").EventTypes.DOWN);\n    };\n    onKeyUp = event => {\n      if (KeyboardEventManager.activationKeys.indexOf(event.key) === -1 || !this.isPressed) {\n        return;\n      }\n      this.dispatchEvent(event, require(_dependencyMap[2], \"../interfaces\").EventTypes.UP);\n    };\n    dispatchEvent(event, eventType) {\n      if (!(event.target instanceof HTMLElement)) {\n        return;\n      }\n      const adaptedEvent = this.mapEvent(event, eventType);\n      switch (eventType) {\n        case require(_dependencyMap[2], \"../interfaces\").EventTypes.UP:\n          this.isPressed = false;\n          this.onPointerUp(adaptedEvent);\n          break;\n        case require(_dependencyMap[2], \"../interfaces\").EventTypes.DOWN:\n          this.isPressed = true;\n          this.onPointerDown(adaptedEvent);\n          break;\n        case require(_dependencyMap[2], \"../interfaces\").EventTypes.CANCEL:\n          this.isPressed = false;\n          this.onPointerCancel(adaptedEvent);\n          break;\n      }\n    }\n    registerListeners() {\n      this.view.addEventListener('keydown', this.keyDownCallback);\n      KeyboardEventManager.instances.add(this);\n      if (!KeyboardEventManager.registeredStaticListeners) {\n        KeyboardEventManager.registeredStaticListeners = true;\n        document.addEventListener('keyup', KeyboardEventManager.keyUpStaticCallback, {\n          capture: true\n        });\n      }\n    }\n    unregisterListeners() {\n      this.view.removeEventListener('keydown', this.keyDownCallback);\n      KeyboardEventManager.instances.delete(this);\n      if (KeyboardEventManager.instances.size === 0) {\n        document.removeEventListener('keyup', KeyboardEventManager.keyUpStaticCallback, {\n          capture: true\n        });\n        KeyboardEventManager.registeredStaticListeners = false;\n      }\n    }\n    mapEvent(event, eventType) {\n      const viewRect = event.target.getBoundingClientRect();\n      const viewportPosition = {\n        x: viewRect?.x + viewRect?.width / 2,\n        y: viewRect?.y + viewRect?.height / 2\n      };\n      const relativePosition = {\n        x: viewRect?.width / 2,\n        y: viewRect?.height / 2\n      };\n      return {\n        x: viewportPosition.x,\n        y: viewportPosition.y,\n        offsetX: relativePosition.x,\n        offsetY: relativePosition.y,\n        pointerId: 0,\n        eventType: eventType,\n        pointerType: require(_dependencyMap[3], \"../../PointerType\").PointerType.KEY,\n        time: event.timeStamp\n      };\n    }\n  }\n  exports.default = KeyboardEventManager;\n});","lineCount":107,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13],[4,6,1,13,"_interopRequireDefault"],[4,28,1,13],[4,31,1,13,"require"],[4,38,1,13],[4,39,1,13,"_dependencyMap"],[4,53,1,13],[5,2,1,13,"Object"],[5,8,1,13],[5,9,1,13,"defineProperty"],[5,23,1,13],[5,24,1,13,"exports"],[5,31,1,13],[6,4,1,13,"value"],[6,9,1,13],[7,2,1,13],[8,2,1,13,"exports"],[8,9,1,13],[8,10,1,13,"default"],[8,17,1,13],[9,2,4,0],[9,6,4,0,"_EventManager"],[9,19,4,0],[9,22,4,0,"_interopRequireDefault"],[9,44,4,0],[9,45,4,0,"require"],[9,52,4,0],[9,53,4,0,"_dependencyMap"],[9,67,4,0],[10,2,6,15],[10,8,6,21,"KeyboardEventManager"],[10,28,6,41],[10,37,6,50,"EventManager"],[10,58,6,62],[10,59,6,63],[11,4,7,2],[11,11,7,9,"activationKeys"],[11,25,7,23],[11,28,7,26],[11,29,7,27],[11,36,7,34],[11,38,7,36],[11,41,7,39],[11,42,7,40],[12,4,8,2],[12,11,8,9,"cancelationKeys"],[12,26,8,24],[12,29,8,27],[12,30,8,28],[12,35,8,33],[12,36,8,34],[13,4,9,2,"isPressed"],[13,13,9,11],[13,16,9,14],[13,21,9,19],[14,4,10,2],[14,11,10,9,"registeredStaticListeners"],[14,36,10,34],[14,39,10,37],[14,44,10,42],[15,4,11,2],[15,11,11,9,"instances"],[15,20,11,18],[15,23,11,21],[15,27,11,25,"Set"],[15,30,11,28],[15,31,11,29],[15,32,11,30],[16,4,12,2],[16,11,12,9,"keyUpStaticCallback"],[16,30,12,28],[16,33,12,31,"event"],[16,38,12,36],[16,42,12,40],[17,6,13,4],[18,6,14,4],[19,6,15,4],[21,6,17,4],[21,10,17,8],[21,14,17,12],[21,15,17,13,"activationKeys"],[21,29,17,27],[21,30,17,28,"indexOf"],[21,37,17,35],[21,38,17,36,"event"],[21,43,17,41],[21,44,17,42,"key"],[21,47,17,45],[21,48,17,46],[21,53,17,51],[21,54,17,52],[21,55,17,53],[21,57,17,55],[22,8,18,6],[23,6,19,4],[24,6,20,4],[24,10,20,8],[24,11,20,9,"instances"],[24,20,20,18],[24,21,20,19,"forEach"],[24,28,20,26],[24,29,20,27,"item"],[24,33,20,31],[24,37,20,35],[25,8,21,6,"item"],[25,12,21,10],[25,13,21,11,"onKeyUp"],[25,20,21,18],[25,21,21,19,"event"],[25,26,21,24],[25,27,21,25],[26,6,22,4],[26,7,22,5],[26,8,22,6],[27,4,23,2],[27,5,23,3],[28,4,24,2,"keyDownCallback"],[28,19,24,17],[28,22,24,20,"event"],[28,27,24,25],[28,31,24,29],[29,6,25,4],[29,10,25,8,"KeyboardEventManager"],[29,30,25,28],[29,31,25,29,"cancelationKeys"],[29,46,25,44],[29,47,25,45,"indexOf"],[29,54,25,52],[29,55,25,53,"event"],[29,60,25,58],[29,61,25,59,"key"],[29,64,25,62],[29,65,25,63],[29,70,25,68],[29,71,25,69],[29,72,25,70],[29,76,25,74],[29,80,25,78],[29,81,25,79,"isPressed"],[29,90,25,88],[29,92,25,90],[30,8,26,6],[30,12,26,10],[30,13,26,11,"dispatchEvent"],[30,26,26,24],[30,27,26,25,"event"],[30,32,26,30],[30,34,26,32,"EventTypes"],[30,60,26,32],[30,61,26,32,"EventTypes"],[30,88,26,42],[30,89,26,43,"CANCEL"],[30,95,26,49],[30,96,26,50],[31,8,27,6],[32,6,28,4],[33,6,29,4],[33,10,29,8,"KeyboardEventManager"],[33,30,29,28],[33,31,29,29,"activationKeys"],[33,45,29,43],[33,46,29,44,"indexOf"],[33,53,29,51],[33,54,29,52,"event"],[33,59,29,57],[33,60,29,58,"key"],[33,63,29,61],[33,64,29,62],[33,69,29,67],[33,70,29,68],[33,71,29,69],[33,73,29,71],[34,8,30,6],[35,6,31,4],[36,6,32,4],[36,10,32,8],[36,11,32,9,"dispatchEvent"],[36,24,32,22],[36,25,32,23,"event"],[36,30,32,28],[36,32,32,30,"EventTypes"],[36,58,32,30],[36,59,32,30,"EventTypes"],[36,86,32,40],[36,87,32,41,"DOWN"],[36,91,32,45],[36,92,32,46],[37,4,33,2],[37,5,33,3],[38,4,34,2,"onKeyUp"],[38,11,34,9],[38,14,34,12,"event"],[38,19,34,17],[38,23,34,21],[39,6,35,4],[39,10,35,8,"KeyboardEventManager"],[39,30,35,28],[39,31,35,29,"activationKeys"],[39,45,35,43],[39,46,35,44,"indexOf"],[39,53,35,51],[39,54,35,52,"event"],[39,59,35,57],[39,60,35,58,"key"],[39,63,35,61],[39,64,35,62],[39,69,35,67],[39,70,35,68],[39,71,35,69],[39,75,35,73],[39,76,35,74],[39,80,35,78],[39,81,35,79,"isPressed"],[39,90,35,88],[39,92,35,90],[40,8,36,6],[41,6,37,4],[42,6,38,4],[42,10,38,8],[42,11,38,9,"dispatchEvent"],[42,24,38,22],[42,25,38,23,"event"],[42,30,38,28],[42,32,38,30,"EventTypes"],[42,58,38,30],[42,59,38,30,"EventTypes"],[42,86,38,40],[42,87,38,41,"UP"],[42,89,38,43],[42,90,38,44],[43,4,39,2],[43,5,39,3],[44,4,40,2,"dispatchEvent"],[44,17,40,15,"dispatchEvent"],[44,18,40,16,"event"],[44,23,40,21],[44,25,40,23,"eventType"],[44,34,40,32],[44,36,40,34],[45,6,41,4],[45,10,41,8],[45,12,41,10,"event"],[45,17,41,15],[45,18,41,16,"target"],[45,24,41,22],[45,36,41,34,"HTMLElement"],[45,47,41,45],[45,48,41,46],[45,50,41,48],[46,8,42,6],[47,6,43,4],[48,6,44,4],[48,12,44,10,"adaptedEvent"],[48,24,44,22],[48,27,44,25],[48,31,44,29],[48,32,44,30,"mapEvent"],[48,40,44,38],[48,41,44,39,"event"],[48,46,44,44],[48,48,44,46,"eventType"],[48,57,44,55],[48,58,44,56],[49,6,45,4],[49,14,45,12,"eventType"],[49,23,45,21],[50,8,46,6],[50,13,46,11,"EventTypes"],[50,39,46,11],[50,40,46,11,"EventTypes"],[50,67,46,21],[50,68,46,22,"UP"],[50,70,46,24],[51,10,47,8],[51,14,47,12],[51,15,47,13,"isPressed"],[51,24,47,22],[51,27,47,25],[51,32,47,30],[52,10,48,8],[52,14,48,12],[52,15,48,13,"onPointerUp"],[52,26,48,24],[52,27,48,25,"adaptedEvent"],[52,39,48,37],[52,40,48,38],[53,10,49,8],[54,8,50,6],[54,13,50,11,"EventTypes"],[54,39,50,11],[54,40,50,11,"EventTypes"],[54,67,50,21],[54,68,50,22,"DOWN"],[54,72,50,26],[55,10,51,8],[55,14,51,12],[55,15,51,13,"isPressed"],[55,24,51,22],[55,27,51,25],[55,31,51,29],[56,10,52,8],[56,14,52,12],[56,15,52,13,"onPointerDown"],[56,28,52,26],[56,29,52,27,"adaptedEvent"],[56,41,52,39],[56,42,52,40],[57,10,53,8],[58,8,54,6],[58,13,54,11,"EventTypes"],[58,39,54,11],[58,40,54,11,"EventTypes"],[58,67,54,21],[58,68,54,22,"CANCEL"],[58,74,54,28],[59,10,55,8],[59,14,55,12],[59,15,55,13,"isPressed"],[59,24,55,22],[59,27,55,25],[59,32,55,30],[60,10,56,8],[60,14,56,12],[60,15,56,13,"onPointerCancel"],[60,30,56,28],[60,31,56,29,"adaptedEvent"],[60,43,56,41],[60,44,56,42],[61,10,57,8],[62,6,58,4],[63,4,59,2],[64,4,60,2,"registerListeners"],[64,21,60,19,"registerListeners"],[64,22,60,19],[64,24,60,22],[65,6,61,4],[65,10,61,8],[65,11,61,9,"view"],[65,15,61,13],[65,16,61,14,"addEventListener"],[65,32,61,30],[65,33,61,31],[65,42,61,40],[65,44,61,42],[65,48,61,46],[65,49,61,47,"keyDownCallback"],[65,64,61,62],[65,65,61,63],[66,6,62,4,"KeyboardEventManager"],[66,26,62,24],[66,27,62,25,"instances"],[66,36,62,34],[66,37,62,35,"add"],[66,40,62,38],[66,41,62,39],[66,45,62,43],[66,46,62,44],[67,6,63,4],[67,10,63,8],[67,11,63,9,"KeyboardEventManager"],[67,31,63,29],[67,32,63,30,"registeredStaticListeners"],[67,57,63,55],[67,59,63,57],[68,8,64,6,"KeyboardEventManager"],[68,28,64,26],[68,29,64,27,"registeredStaticListeners"],[68,54,64,52],[68,57,64,55],[68,61,64,59],[69,8,65,6,"document"],[69,16,65,14],[69,17,65,15,"addEventListener"],[69,33,65,31],[69,34,65,32],[69,41,65,39],[69,43,65,41,"KeyboardEventManager"],[69,63,65,61],[69,64,65,62,"keyUpStaticCallback"],[69,83,65,81],[69,85,65,83],[70,10,66,8,"capture"],[70,17,66,15],[70,19,66,17],[71,8,67,6],[71,9,67,7],[71,10,67,8],[72,6,68,4],[73,4,69,2],[74,4,70,2,"unregisterListeners"],[74,23,70,21,"unregisterListeners"],[74,24,70,21],[74,26,70,24],[75,6,71,4],[75,10,71,8],[75,11,71,9,"view"],[75,15,71,13],[75,16,71,14,"removeEventListener"],[75,35,71,33],[75,36,71,34],[75,45,71,43],[75,47,71,45],[75,51,71,49],[75,52,71,50,"keyDownCallback"],[75,67,71,65],[75,68,71,66],[76,6,72,4,"KeyboardEventManager"],[76,26,72,24],[76,27,72,25,"instances"],[76,36,72,34],[76,37,72,35,"delete"],[76,43,72,41],[76,44,72,42],[76,48,72,46],[76,49,72,47],[77,6,73,4],[77,10,73,8,"KeyboardEventManager"],[77,30,73,28],[77,31,73,29,"instances"],[77,40,73,38],[77,41,73,39,"size"],[77,45,73,43],[77,50,73,48],[77,51,73,49],[77,53,73,51],[78,8,74,6,"document"],[78,16,74,14],[78,17,74,15,"removeEventListener"],[78,36,74,34],[78,37,74,35],[78,44,74,42],[78,46,74,44,"KeyboardEventManager"],[78,66,74,64],[78,67,74,65,"keyUpStaticCallback"],[78,86,74,84],[78,88,74,86],[79,10,75,8,"capture"],[79,17,75,15],[79,19,75,17],[80,8,76,6],[80,9,76,7],[80,10,76,8],[81,8,77,6,"KeyboardEventManager"],[81,28,77,26],[81,29,77,27,"registeredStaticListeners"],[81,54,77,52],[81,57,77,55],[81,62,77,60],[82,6,78,4],[83,4,79,2],[84,4,80,2,"mapEvent"],[84,12,80,10,"mapEvent"],[84,13,80,11,"event"],[84,18,80,16],[84,20,80,18,"eventType"],[84,29,80,27],[84,31,80,29],[85,6,81,4],[85,12,81,10,"viewRect"],[85,20,81,18],[85,23,81,21,"event"],[85,28,81,26],[85,29,81,27,"target"],[85,35,81,33],[85,36,81,34,"getBoundingClientRect"],[85,57,81,55],[85,58,81,56],[85,59,81,57],[86,6,82,4],[86,12,82,10,"viewportPosition"],[86,28,82,26],[86,31,82,29],[87,8,83,6,"x"],[87,9,83,7],[87,11,83,9,"viewRect"],[87,19,83,17],[87,21,83,19,"x"],[87,22,83,20],[87,25,83,23,"viewRect"],[87,33,83,31],[87,35,83,33,"width"],[87,40,83,38],[87,43,83,41],[87,44,83,42],[88,8,84,6,"y"],[88,9,84,7],[88,11,84,9,"viewRect"],[88,19,84,17],[88,21,84,19,"y"],[88,22,84,20],[88,25,84,23,"viewRect"],[88,33,84,31],[88,35,84,33,"height"],[88,41,84,39],[88,44,84,42],[89,6,85,4],[89,7,85,5],[90,6,86,4],[90,12,86,10,"relativePosition"],[90,28,86,26],[90,31,86,29],[91,8,87,6,"x"],[91,9,87,7],[91,11,87,9,"viewRect"],[91,19,87,17],[91,21,87,19,"width"],[91,26,87,24],[91,29,87,27],[91,30,87,28],[92,8,88,6,"y"],[92,9,88,7],[92,11,88,9,"viewRect"],[92,19,88,17],[92,21,88,19,"height"],[92,27,88,25],[92,30,88,28],[93,6,89,4],[93,7,89,5],[94,6,90,4],[94,13,90,11],[95,8,91,6,"x"],[95,9,91,7],[95,11,91,9,"viewportPosition"],[95,27,91,25],[95,28,91,26,"x"],[95,29,91,27],[96,8,92,6,"y"],[96,9,92,7],[96,11,92,9,"viewportPosition"],[96,27,92,25],[96,28,92,26,"y"],[96,29,92,27],[97,8,93,6,"offsetX"],[97,15,93,13],[97,17,93,15,"relativePosition"],[97,33,93,31],[97,34,93,32,"x"],[97,35,93,33],[98,8,94,6,"offsetY"],[98,15,94,13],[98,17,94,15,"relativePosition"],[98,33,94,31],[98,34,94,32,"y"],[98,35,94,33],[99,8,95,6,"pointerId"],[99,17,95,15],[99,19,95,17],[99,20,95,18],[100,8,96,6,"eventType"],[100,17,96,15],[100,19,96,17,"eventType"],[100,28,96,26],[101,8,97,6,"pointerType"],[101,19,97,17],[101,21,97,19,"PointerType"],[101,47,97,19],[101,48,97,19,"PointerType"],[101,80,97,30],[101,81,97,31,"KEY"],[101,84,97,34],[102,8,98,6,"time"],[102,12,98,10],[102,14,98,12,"event"],[102,19,98,17],[102,20,98,18,"timeStamp"],[103,6,99,4],[103,7,99,5],[104,4,100,2],[105,2,101,0],[106,2,101,1,"exports"],[106,9,101,1],[106,10,101,1,"default"],[106,17,101,1],[106,20,101,1,"KeyboardEventManager"],[106,40,101,1],[107,0,101,1],[107,3]],"functionMap":{"names":["<global>","KeyboardEventManager","keyUpStaticCallback","instances.forEach$argument_0","keyDownCallback","onKeyUp","dispatchEvent","registerListeners","unregisterListeners","mapEvent"],"mappings":"AAA;eCK;+BCM;2BCQ;KDE;GDC;oBGC;GHS;YIC;GJK;EKC;GLmB;EMC;GNS;EOC;GPS;EQC;GRoB;CDC"}},"type":"js/module"}]}