{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/classCallCheck","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"yg7e6laZwmpbIvId5jovq9ugXp8=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/createClass","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"Z6pzkVZ2fvxBLkFTgVVOy4UDj30=","exportNames":["*"],"imports":1}},{"name":"./logging/logger","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":41,"column":0,"index":1290},"end":{"line":41,"column":39,"index":1329}},{"start":{"line":41,"column":0,"index":1290},"end":{"line":41,"column":39,"index":1329}},{"start":{"line":41,"column":0,"index":1290},"end":{"line":41,"column":39,"index":1329}},{"start":{"line":41,"column":0,"index":1290},"end":{"line":41,"column":39,"index":1329}},{"start":{"line":41,"column":0,"index":1290},"end":{"line":41,"column":39,"index":1329}},{"start":{"line":41,"column":0,"index":1290},"end":{"line":41,"column":39,"index":1329}}],"key":"AG5tn3FQlAEVwMz6R1Rqy2CuHrs=","exportNames":["*"],"imports":6}},{"name":"../presentation/presentationStore","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":40,"column":0,"index":1216},"end":{"line":40,"column":73,"index":1289}}],"key":"BamEkPJVRrxYlxmHCpwPFKoMCe8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\").default;\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.ReEnrichmentCoordinator = void 0;\n  var _classCallCheck2 = _interopRequireDefault(require(_dependencyMap[1], \"@babel/runtime/helpers/classCallCheck\"));\n  var _createClass2 = _interopRequireDefault(require(_dependencyMap[2], \"@babel/runtime/helpers/createClass\"));\n  /**\n   * ReEnrichmentCoordinator - Global Re-Enrichment Manager\n   *\n   * **Purpose:**\n   * Coordinates re-enrichment across all sensor instances when presentation\n   * preferences change. Debounces re-enrichment to prevent performance issues\n   * during rapid preference changes.\n   *\n   * **Architecture:**\n   * - Singleton service\n   * - Registers sensor instances for coordinated updates\n   * - Single debounce timer for all sensors (not per-sensor)\n   * - Subscribes to presentation store changes\n   * - Batch re-enrichment for efficiency\n   *\n   * **Usage:**\n   * ```typescript\n   * // Initialize once at app startup\n   * ReEnrichmentCoordinator.initialize();\n   *\n   * // Register sensor instances (done by nmeaStore)\n   * ReEnrichmentCoordinator.register(sensorInstance);\n   *\n   * // Unregister on cleanup\n   * ReEnrichmentCoordinator.unregister(sensorInstance);\n   *\n   * // Manual trigger (usually automatic via subscription)\n   * ReEnrichmentCoordinator.triggerReEnrichment();\n   * ```\n   *\n   * **Benefits:**\n   * - ✅ Single debounce timer (efficient)\n   * - ✅ Batch re-enrichment (all sensors at once)\n   * - ✅ Automatic on presentation changes\n   * - ✅ Performance logging\n   * - ✅ Clean instance management\n   */\n  /**\n   * Re-Enrichment Coordinator Service\n   * Singleton managing global re-enrichment\n   */\n  var ReEnrichmentCoordinatorService = /*#__PURE__*/function () {\n    function ReEnrichmentCoordinatorService() {\n      (0, _classCallCheck2.default)(this, ReEnrichmentCoordinatorService);\n      this.instances = new Set();\n      this.DEBOUNCE_MS = 100;\n    }\n    return (0, _createClass2.default)(ReEnrichmentCoordinatorService, [{\n      key: \"register\",\n      value:\n      /**\n       * Register sensor instance for coordinated re-enrichment\n       * Called by nmeaStore when creating new sensor instances\n       *\n       * @param instance - Sensor instance to register\n       */\n      function register(instance) {\n        this.instances.add(instance);\n        require(_dependencyMap[3], \"./logging/logger\").log.app('Sensor instance registered for re-enrichment', () => ({\n          type: instance.type,\n          instance: instance.instance,\n          totalInstances: this.instances.size\n        }));\n      }\n\n      /**\n       * Unregister sensor instance\n       * Called during cleanup or factory reset\n       *\n       * @param instance - Sensor instance to unregister\n       */\n    }, {\n      key: \"unregister\",\n      value: function unregister(instance) {\n        this.instances.delete(instance);\n        require(_dependencyMap[3], \"./logging/logger\").log.app('Sensor instance unregistered from re-enrichment', () => ({\n          type: instance.type,\n          instance: instance.instance,\n          totalInstances: this.instances.size\n        }));\n      }\n\n      /**\n       * Trigger re-enrichment (debounced)\n       * Called automatically when presentation preferences change\n       *\n       * Debounces to prevent excessive re-enrichment during rapid changes\n       * (e.g., user scrolling through unit preferences)\n       */\n    }, {\n      key: \"triggerReEnrichment\",\n      value: function triggerReEnrichment() {\n        if (this.debounceTimer) {\n          clearTimeout(this.debounceTimer);\n        }\n        this.debounceTimer = setTimeout(() => {\n          var startTime = Date.now();\n\n          // Batch re-enrich all sensor instances\n          for (var instance of this.instances) {\n            instance.reEnrich();\n          }\n          var duration = Date.now() - startTime;\n          require(_dependencyMap[3], \"./logging/logger\").log.app('Global re-enrichment complete', () => ({\n            instanceCount: this.instances.size,\n            durationMs: duration,\n            avgPerInstance: this.instances.size > 0 ? duration / this.instances.size : 0\n          }));\n        }, this.DEBOUNCE_MS);\n      }\n\n      /**\n       * Initialize subscription to presentation changes\n       * Call once at app startup\n       *\n       * @example\n       * // In App.tsx or index.js\n       * ReEnrichmentCoordinator.initialize();\n       */\n    }, {\n      key: \"initialize\",\n      value: function initialize() {\n        if (this.unsubscribe) {\n          // Already initialized\n          return;\n        }\n        this.unsubscribe = require(_dependencyMap[4], \"../presentation/presentationStore\").usePresentationStore.subscribe((state, prevState) => {\n          if (state.selectedPresentations !== prevState.selectedPresentations) {\n            require(_dependencyMap[3], \"./logging/logger\").log.app('Presentation change detected, triggering re-enrichment');\n            this.triggerReEnrichment();\n          }\n        });\n        require(_dependencyMap[3], \"./logging/logger\").log.app('ReEnrichmentCoordinator initialized');\n      }\n\n      /**\n       * Cleanup (for testing or shutdown)\n       */\n    }, {\n      key: \"destroy\",\n      value: function destroy() {\n        if (this.debounceTimer) {\n          clearTimeout(this.debounceTimer);\n          this.debounceTimer = undefined;\n        }\n        if (this.unsubscribe) {\n          this.unsubscribe();\n          this.unsubscribe = undefined;\n        }\n        this.instances.clear();\n        require(_dependencyMap[3], \"./logging/logger\").log.app('ReEnrichmentCoordinator destroyed');\n      }\n\n      /**\n       * Get coordinator statistics (for debugging)\n       */\n    }, {\n      key: \"getStats\",\n      value: function getStats() {\n        return {\n          registeredInstances: this.instances.size,\n          isInitialized: !!this.unsubscribe\n        };\n      }\n    }]);\n  }();\n  /**\n   * Singleton instance\n   * Import and use this in your application\n   */\n  var ReEnrichmentCoordinator = exports.ReEnrichmentCoordinator = new ReEnrichmentCoordinatorService();\n});","lineCount":180,"map":[[9,2,1,0],[10,0,2,0],[11,0,3,0],[12,0,4,0],[13,0,5,0],[14,0,6,0],[15,0,7,0],[16,0,8,0],[17,0,9,0],[18,0,10,0],[19,0,11,0],[20,0,12,0],[21,0,13,0],[22,0,14,0],[23,0,15,0],[24,0,16,0],[25,0,17,0],[26,0,18,0],[27,0,19,0],[28,0,20,0],[29,0,21,0],[30,0,22,0],[31,0,23,0],[32,0,24,0],[33,0,25,0],[34,0,26,0],[35,0,27,0],[36,0,28,0],[37,0,29,0],[38,0,30,0],[39,0,31,0],[40,0,32,0],[41,0,33,0],[42,0,34,0],[43,0,35,0],[44,0,36,0],[45,0,37,0],[46,2,43,0],[47,0,44,0],[48,0,45,0],[49,0,46,0],[50,2,43,0],[50,6,47,6,"ReEnrichmentCoordinatorService"],[50,36,47,36],[51,4,47,36],[51,13,47,36,"ReEnrichmentCoordinatorService"],[51,44,47,36],[52,6,47,36],[52,10,47,36,"_classCallCheck2"],[52,26,47,36],[52,27,47,36,"default"],[52,34,47,36],[52,42,47,36,"ReEnrichmentCoordinatorService"],[52,72,47,36],[53,6,47,36],[53,11,48,10,"instances"],[53,20,48,19],[53,23,48,48],[53,27,48,52,"Set"],[53,30,48,55],[53,31,48,56],[53,32,48,57],[54,6,48,57],[54,11,50,19,"DEBOUNCE_MS"],[54,22,50,30],[54,25,50,33],[54,28,50,36],[55,4,50,36],[56,4,50,36],[56,15,50,36,"_createClass2"],[56,28,50,36],[56,29,50,36,"default"],[56,36,50,36],[56,38,50,36,"ReEnrichmentCoordinatorService"],[56,68,50,36],[57,6,50,36,"key"],[57,9,50,36],[58,6,50,36,"value"],[58,11,50,36],[59,6,53,2],[60,0,54,0],[61,0,55,0],[62,0,56,0],[63,0,57,0],[64,0,58,0],[65,6,59,2],[65,15,59,2,"register"],[65,23,59,10,"register"],[65,24,59,11,"instance"],[65,32,59,40],[65,34,59,48],[66,8,60,4],[66,12,60,8],[66,13,60,9,"instances"],[66,22,60,18],[66,23,60,19,"add"],[66,26,60,22],[66,27,60,23,"instance"],[66,35,60,31],[66,36,60,32],[67,8,62,4,"log"],[67,34,62,4],[67,35,62,4,"log"],[67,58,62,7],[67,59,62,8,"app"],[67,62,62,11],[67,63,62,12],[67,109,62,58],[67,111,62,60],[67,118,62,67],[68,10,63,6,"type"],[68,14,63,10],[68,16,63,12,"instance"],[68,24,63,20],[68,25,63,21,"type"],[68,29,63,25],[69,10,64,6,"instance"],[69,18,64,14],[69,20,64,16,"instance"],[69,28,64,24],[69,29,64,25,"instance"],[69,37,64,33],[70,10,65,6,"totalInstances"],[70,24,65,20],[70,26,65,22],[70,30,65,26],[70,31,65,27,"instances"],[70,40,65,36],[70,41,65,37,"size"],[71,8,66,4],[71,9,66,5],[71,10,66,6],[71,11,66,7],[72,6,67,2],[74,6,69,2],[75,0,70,0],[76,0,71,0],[77,0,72,0],[78,0,73,0],[79,0,74,0],[80,4,69,2],[81,6,69,2,"key"],[81,9,69,2],[82,6,69,2,"value"],[82,11,69,2],[82,13,75,2],[82,22,75,2,"unregister"],[82,32,75,12,"unregister"],[82,33,75,13,"instance"],[82,41,75,42],[82,43,75,50],[83,8,76,4],[83,12,76,8],[83,13,76,9,"instances"],[83,22,76,18],[83,23,76,19,"delete"],[83,29,76,25],[83,30,76,26,"instance"],[83,38,76,34],[83,39,76,35],[84,8,78,4,"log"],[84,34,78,4],[84,35,78,4,"log"],[84,58,78,7],[84,59,78,8,"app"],[84,62,78,11],[84,63,78,12],[84,112,78,61],[84,114,78,63],[84,121,78,70],[85,10,79,6,"type"],[85,14,79,10],[85,16,79,12,"instance"],[85,24,79,20],[85,25,79,21,"type"],[85,29,79,25],[86,10,80,6,"instance"],[86,18,80,14],[86,20,80,16,"instance"],[86,28,80,24],[86,29,80,25,"instance"],[86,37,80,33],[87,10,81,6,"totalInstances"],[87,24,81,20],[87,26,81,22],[87,30,81,26],[87,31,81,27,"instances"],[87,40,81,36],[87,41,81,37,"size"],[88,8,82,4],[88,9,82,5],[88,10,82,6],[88,11,82,7],[89,6,83,2],[91,6,85,2],[92,0,86,0],[93,0,87,0],[94,0,88,0],[95,0,89,0],[96,0,90,0],[97,0,91,0],[98,4,85,2],[99,6,85,2,"key"],[99,9,85,2],[100,6,85,2,"value"],[100,11,85,2],[100,13,92,2],[100,22,92,2,"triggerReEnrichment"],[100,41,92,21,"triggerReEnrichment"],[100,42,92,21],[100,44,92,30],[101,8,93,4],[101,12,93,8],[101,16,93,12],[101,17,93,13,"debounceTimer"],[101,30,93,26],[101,32,93,28],[102,10,94,6,"clearTimeout"],[102,22,94,18],[102,23,94,19],[102,27,94,23],[102,28,94,24,"debounceTimer"],[102,41,94,37],[102,42,94,38],[103,8,95,4],[104,8,97,4],[104,12,97,8],[104,13,97,9,"debounceTimer"],[104,26,97,22],[104,29,97,25,"setTimeout"],[104,39,97,35],[104,40,97,36],[104,46,97,42],[105,10,98,6],[105,14,98,12,"startTime"],[105,23,98,21],[105,26,98,24,"Date"],[105,30,98,28],[105,31,98,29,"now"],[105,34,98,32],[105,35,98,33],[105,36,98,34],[107,10,100,6],[108,10,101,6],[108,15,101,11],[108,19,101,17,"instance"],[108,27,101,25],[108,31,101,29],[108,35,101,33],[108,36,101,34,"instances"],[108,45,101,43],[108,47,101,45],[109,12,102,8,"instance"],[109,20,102,16],[109,21,102,17,"reEnrich"],[109,29,102,25],[109,30,102,26],[109,31,102,27],[110,10,103,6],[111,10,105,6],[111,14,105,12,"duration"],[111,22,105,20],[111,25,105,23,"Date"],[111,29,105,27],[111,30,105,28,"now"],[111,33,105,31],[111,34,105,32],[111,35,105,33],[111,38,105,36,"startTime"],[111,47,105,45],[112,10,107,6,"log"],[112,36,107,6],[112,37,107,6,"log"],[112,60,107,9],[112,61,107,10,"app"],[112,64,107,13],[112,65,107,14],[112,96,107,45],[112,98,107,47],[112,105,107,54],[113,12,108,8,"instanceCount"],[113,25,108,21],[113,27,108,23],[113,31,108,27],[113,32,108,28,"instances"],[113,41,108,37],[113,42,108,38,"size"],[113,46,108,42],[114,12,109,8,"durationMs"],[114,22,109,18],[114,24,109,20,"duration"],[114,32,109,28],[115,12,110,8,"avgPerInstance"],[115,26,110,22],[115,28,110,24],[115,32,110,28],[115,33,110,29,"instances"],[115,42,110,38],[115,43,110,39,"size"],[115,47,110,43],[115,50,110,46],[115,51,110,47],[115,54,110,50,"duration"],[115,62,110,58],[115,65,110,61],[115,69,110,65],[115,70,110,66,"instances"],[115,79,110,75],[115,80,110,76,"size"],[115,84,110,80],[115,87,110,83],[116,10,111,6],[116,11,111,7],[116,12,111,8],[116,13,111,9],[117,8,112,4],[117,9,112,5],[117,11,112,7],[117,15,112,11],[117,16,112,12,"DEBOUNCE_MS"],[117,27,112,23],[117,28,112,24],[118,6,113,2],[120,6,115,2],[121,0,116,0],[122,0,117,0],[123,0,118,0],[124,0,119,0],[125,0,120,0],[126,0,121,0],[127,0,122,0],[128,4,115,2],[129,6,115,2,"key"],[129,9,115,2],[130,6,115,2,"value"],[130,11,115,2],[130,13,123,2],[130,22,123,2,"initialize"],[130,32,123,12,"initialize"],[130,33,123,12],[130,35,123,21],[131,8,124,4],[131,12,124,8],[131,16,124,12],[131,17,124,13,"unsubscribe"],[131,28,124,24],[131,30,124,26],[132,10,125,6],[133,10,126,6],[134,8,127,4],[135,8,129,4],[135,12,129,8],[135,13,129,9,"unsubscribe"],[135,24,129,20],[135,27,129,23,"usePresentationStore"],[135,53,129,23],[135,54,129,23,"usePresentationStore"],[135,111,129,43],[135,112,129,44,"subscribe"],[135,121,129,53],[135,122,129,54],[135,123,129,55,"state"],[135,128,129,60],[135,130,129,62,"prevState"],[135,139,129,71],[135,144,129,76],[136,10,130,6],[136,14,130,10,"state"],[136,19,130,15],[136,20,130,16,"selectedPresentations"],[136,41,130,37],[136,46,130,42,"prevState"],[136,55,130,51],[136,56,130,52,"selectedPresentations"],[136,77,130,73],[136,79,130,75],[137,12,131,8,"log"],[137,38,131,8],[137,39,131,8,"log"],[137,62,131,11],[137,63,131,12,"app"],[137,66,131,15],[137,67,131,16],[137,123,131,72],[137,124,131,73],[138,12,132,8],[138,16,132,12],[138,17,132,13,"triggerReEnrichment"],[138,36,132,32],[138,37,132,33],[138,38,132,34],[139,10,133,6],[140,8,134,4],[140,9,134,5],[140,10,134,6],[141,8,136,4,"log"],[141,34,136,4],[141,35,136,4,"log"],[141,58,136,7],[141,59,136,8,"app"],[141,62,136,11],[141,63,136,12],[141,100,136,49],[141,101,136,50],[142,6,137,2],[144,6,139,2],[145,0,140,0],[146,0,141,0],[147,4,139,2],[148,6,139,2,"key"],[148,9,139,2],[149,6,139,2,"value"],[149,11,139,2],[149,13,142,2],[149,22,142,2,"destroy"],[149,29,142,9,"destroy"],[149,30,142,9],[149,32,142,18],[150,8,143,4],[150,12,143,8],[150,16,143,12],[150,17,143,13,"debounceTimer"],[150,30,143,26],[150,32,143,28],[151,10,144,6,"clearTimeout"],[151,22,144,18],[151,23,144,19],[151,27,144,23],[151,28,144,24,"debounceTimer"],[151,41,144,37],[151,42,144,38],[152,10,145,6],[152,14,145,10],[152,15,145,11,"debounceTimer"],[152,28,145,24],[152,31,145,27,"undefined"],[152,40,145,36],[153,8,146,4],[154,8,148,4],[154,12,148,8],[154,16,148,12],[154,17,148,13,"unsubscribe"],[154,28,148,24],[154,30,148,26],[155,10,149,6],[155,14,149,10],[155,15,149,11,"unsubscribe"],[155,26,149,22],[155,27,149,23],[155,28,149,24],[156,10,150,6],[156,14,150,10],[156,15,150,11,"unsubscribe"],[156,26,150,22],[156,29,150,25,"undefined"],[156,38,150,34],[157,8,151,4],[158,8,153,4],[158,12,153,8],[158,13,153,9,"instances"],[158,22,153,18],[158,23,153,19,"clear"],[158,28,153,24],[158,29,153,25],[158,30,153,26],[159,8,155,4,"log"],[159,34,155,4],[159,35,155,4,"log"],[159,58,155,7],[159,59,155,8,"app"],[159,62,155,11],[159,63,155,12],[159,98,155,47],[159,99,155,48],[160,6,156,2],[162,6,158,2],[163,0,159,0],[164,0,160,0],[165,4,158,2],[166,6,158,2,"key"],[166,9,158,2],[167,6,158,2,"value"],[167,11,158,2],[167,13,161,2],[167,22,161,2,"getStats"],[167,30,161,10,"getStats"],[167,31,161,10],[167,33,161,70],[168,8,162,4],[168,15,162,11],[169,10,163,6,"registeredInstances"],[169,29,163,25],[169,31,163,27],[169,35,163,31],[169,36,163,32,"instances"],[169,45,163,41],[169,46,163,42,"size"],[169,50,163,46],[170,10,164,6,"isInitialized"],[170,23,164,19],[170,25,164,21],[170,26,164,22],[170,27,164,23],[170,31,164,27],[170,32,164,28,"unsubscribe"],[171,8,165,4],[171,9,165,5],[172,6,166,2],[173,4,166,3],[174,2,166,3],[175,2,169,0],[176,0,170,0],[177,0,171,0],[178,0,172,0],[179,2,173,7],[179,6,173,13,"ReEnrichmentCoordinator"],[179,29,173,36],[179,32,173,36,"exports"],[179,39,173,36],[179,40,173,36,"ReEnrichmentCoordinator"],[179,63,173,36],[179,66,173,39],[179,70,173,43,"ReEnrichmentCoordinatorService"],[179,100,173,73],[179,101,173,74],[179,102,173,75],[180,0,173,76],[180,3]],"functionMap":{"names":["<global>","ReEnrichmentCoordinatorService","ReEnrichmentCoordinatorService#register","log.app$argument_1","ReEnrichmentCoordinatorService#unregister","ReEnrichmentCoordinatorService#triggerReEnrichment","setTimeout$argument_0","ReEnrichmentCoordinatorService#initialize","usePresentationStore.subscribe$argument_0","ReEnrichmentCoordinatorService#destroy","ReEnrichmentCoordinatorService#getStats"],"mappings":"AAA;AC8C;ECY;4DCG;MDI;GDC;EGQ;+DDG;MCI;GHC;EIS;oCCK;+CHU;QGI;KDC;GJC;EMU;sDCM;KDK;GNG;EQK;GRc;ESK;GTK;CDC"}},"type":"js/module"}]}