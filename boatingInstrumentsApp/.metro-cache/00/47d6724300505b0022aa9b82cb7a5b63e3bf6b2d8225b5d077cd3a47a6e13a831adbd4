{"dependencies":[{"name":"../platformFunctions/findNodeHandle","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":69,"index":84}},{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":69,"index":84}},{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":69,"index":84}}],"key":"1isdGYORv8bBV0ZCFH0po00eajE=","exportNames":["*"],"imports":3}},{"name":"./utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":150},"end":{"line":5,"column":33,"index":183}}],"key":"NIaSEHO1E48gsZc7jH9Ex1xTHgE=","exportNames":["*"],"imports":1}},{"name":"../WorkletEventHandler.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":85},"end":{"line":4,"column":64,"index":149}}],"key":"e5fG6a6nTf5/kChbWzO7k8c/97s=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.NativeEventsManager = void 0;\n  class NativeEventsManager {\n    #managedComponent;\n    #componentOptions;\n    #eventViewTag = -1;\n    constructor(component, options) {\n      this.#managedComponent = component;\n      this.#componentOptions = options;\n      this.#eventViewTag = this.getEventViewTag();\n    }\n    attachEvents() {\n      executeForEachEventHandler(this.#managedComponent.props, (key, handler) => {\n        handler.registerForEvents(this.#eventViewTag, key);\n      });\n    }\n    detachEvents() {\n      executeForEachEventHandler(this.#managedComponent.props, (_key, handler) => {\n        handler.unregisterFromEvents(this.#eventViewTag);\n      });\n    }\n    updateEvents(prevProps) {\n      const computedEventTag = this.getEventViewTag(true);\n      // If the event view tag changes, we need to completely re-mount all events\n      if (this.#eventViewTag !== computedEventTag) {\n        // Remove all bindings from previous props that ran on the old viewTag\n        executeForEachEventHandler(prevProps, (_key, handler) => {\n          handler.unregisterFromEvents(this.#eventViewTag);\n        });\n        // We don't need to unregister from current (new) props, because their events weren't registered yet\n        // Replace the view tag\n        this.#eventViewTag = computedEventTag;\n        // Attach the events with a new viewTag\n        this.attachEvents();\n        return;\n      }\n      executeForEachEventHandler(prevProps, (key, prevHandler) => {\n        const newProp = this.#managedComponent.props[key];\n        if (!newProp) {\n          // Prop got deleted\n          prevHandler.unregisterFromEvents(this.#eventViewTag);\n        } else if (isWorkletEventHandler(newProp) && newProp.workletEventHandler !== prevHandler) {\n          // Prop got changed\n          prevHandler.unregisterFromEvents(this.#eventViewTag);\n          newProp.workletEventHandler.registerForEvents(this.#eventViewTag);\n        }\n      });\n      executeForEachEventHandler(this.#managedComponent.props, (key, handler) => {\n        if (!prevProps[key]) {\n          // Prop got added\n          handler.registerForEvents(this.#eventViewTag);\n        }\n      });\n    }\n    getEventViewTag(componentUpdate = false) {\n      // Get the tag for registering events - since the event emitting view can be nested inside the main component\n      const componentAnimatedRef = this.#managedComponent._componentRef;\n      if (componentAnimatedRef?.getScrollableNode) {\n        /*\n          In most cases, getScrollableNode() returns a view tag, and findNodeHandle is not required. \n          However, to cover more exotic list cases, we will continue to use findNodeHandle \n          for consistency. For numerical values, findNodeHandle should return the value immediately, \n          as documented here: https://github.com/facebook/react/blob/91061073d57783c061889ac6720ef1ab7f0c2149/packages/react-native-renderer/src/ReactNativePublicCompat.js#L113\n        */\n        const scrollableNode = componentAnimatedRef.getScrollableNode();\n        if (typeof scrollableNode === 'number') {\n          return scrollableNode;\n        }\n        return (0, require(_dependencyMap[0], \"../platformFunctions/findNodeHandle\").findNodeHandle)(scrollableNode) ?? -1;\n      }\n      if (this.#componentOptions?.setNativeProps) {\n        // This case ensures backward compatibility with components that\n        // have their own setNativeProps method passed as an option.\n        return (0, require(_dependencyMap[0], \"../platformFunctions/findNodeHandle\").findNodeHandle)(this.#managedComponent) ?? -1;\n      }\n      if (!componentUpdate) {\n        // On the first render of a component, we may already receive a resolved view tag.\n        return this.#managedComponent.getComponentViewTag();\n      }\n      if (componentAnimatedRef?.__nativeTag || componentAnimatedRef?._nativeTag) {\n        /*\n          Fast path for native refs,\n          _nativeTag is used by Paper components,\n          __nativeTag is used by Fabric components.\n        */\n        return componentAnimatedRef.__nativeTag ?? componentAnimatedRef._nativeTag ?? -1;\n      }\n      /*\n        When a component is updated, a child could potentially change and have a different \n        view tag. This can occur with a GestureDetector component.\n      */\n      return (0, require(_dependencyMap[0], \"../platformFunctions/findNodeHandle\").findNodeHandle)(componentAnimatedRef) ?? -1;\n    }\n  }\n  exports.NativeEventsManager = NativeEventsManager;\n  function isWorkletEventHandler(prop) {\n    return (0, require(_dependencyMap[1], \"./utils.js\").has)('workletEventHandler', prop) && prop.workletEventHandler instanceof require(_dependencyMap[2], \"../WorkletEventHandler.js\").WorkletEventHandler;\n  }\n  function executeForEachEventHandler(props, callback) {\n    for (const key in props) {\n      const prop = props[key];\n      if (isWorkletEventHandler(prop)) {\n        callback(key, prop.workletEventHandler);\n      }\n    }\n  }\n});","lineCount":112,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13,"Object"],[4,8,1,13],[4,9,1,13,"defineProperty"],[4,23,1,13],[4,24,1,13,"exports"],[4,31,1,13],[5,4,1,13,"value"],[5,9,1,13],[6,2,1,13],[7,2,1,13,"exports"],[7,9,1,13],[7,10,1,13,"NativeEventsManager"],[7,29,1,13],[8,2,6,7],[8,8,6,13,"NativeEventsManager"],[8,27,6,32],[8,28,6,33],[9,4,7,2],[9,5,7,3,"managedComponent"],[9,21,7,19],[10,4,8,2],[10,5,8,3,"componentOptions"],[10,21,8,19],[11,4,9,2],[11,5,9,3,"eventViewTag"],[11,17,9,15],[11,20,9,18],[11,21,9,19],[11,22,9,20],[12,4,10,2,"constructor"],[12,15,10,13,"constructor"],[12,16,10,14,"component"],[12,25,10,23],[12,27,10,25,"options"],[12,34,10,32],[12,36,10,34],[13,6,11,4],[13,10,11,8],[13,11,11,9],[13,12,11,10,"managedComponent"],[13,28,11,26],[13,31,11,29,"component"],[13,40,11,38],[14,6,12,4],[14,10,12,8],[14,11,12,9],[14,12,12,10,"componentOptions"],[14,28,12,26],[14,31,12,29,"options"],[14,38,12,36],[15,6,13,4],[15,10,13,8],[15,11,13,9],[15,12,13,10,"eventViewTag"],[15,24,13,22],[15,27,13,25],[15,31,13,29],[15,32,13,30,"getEventViewTag"],[15,47,13,45],[15,48,13,46],[15,49,13,47],[16,4,14,2],[17,4,15,2,"attachEvents"],[17,16,15,14,"attachEvents"],[17,17,15,14],[17,19,15,17],[18,6,16,4,"executeForEachEventHandler"],[18,32,16,30],[18,33,16,31],[18,37,16,35],[18,38,16,36],[18,39,16,37,"managedComponent"],[18,55,16,53],[18,56,16,54,"props"],[18,61,16,59],[18,63,16,61],[18,64,16,62,"key"],[18,67,16,65],[18,69,16,67,"handler"],[18,76,16,74],[18,81,16,79],[19,8,17,6,"handler"],[19,15,17,13],[19,16,17,14,"registerForEvents"],[19,33,17,31],[19,34,17,32],[19,38,17,36],[19,39,17,37],[19,40,17,38,"eventViewTag"],[19,52,17,50],[19,54,17,52,"key"],[19,57,17,55],[19,58,17,56],[20,6,18,4],[20,7,18,5],[20,8,18,6],[21,4,19,2],[22,4,20,2,"detachEvents"],[22,16,20,14,"detachEvents"],[22,17,20,14],[22,19,20,17],[23,6,21,4,"executeForEachEventHandler"],[23,32,21,30],[23,33,21,31],[23,37,21,35],[23,38,21,36],[23,39,21,37,"managedComponent"],[23,55,21,53],[23,56,21,54,"props"],[23,61,21,59],[23,63,21,61],[23,64,21,62,"_key"],[23,68,21,66],[23,70,21,68,"handler"],[23,77,21,75],[23,82,21,80],[24,8,22,6,"handler"],[24,15,22,13],[24,16,22,14,"unregisterFromEvents"],[24,36,22,34],[24,37,22,35],[24,41,22,39],[24,42,22,40],[24,43,22,41,"eventViewTag"],[24,55,22,53],[24,56,22,54],[25,6,23,4],[25,7,23,5],[25,8,23,6],[26,4,24,2],[27,4,25,2,"updateEvents"],[27,16,25,14,"updateEvents"],[27,17,25,15,"prevProps"],[27,26,25,24],[27,28,25,26],[28,6,26,4],[28,12,26,10,"computedEventTag"],[28,28,26,26],[28,31,26,29],[28,35,26,33],[28,36,26,34,"getEventViewTag"],[28,51,26,49],[28,52,26,50],[28,56,26,54],[28,57,26,55],[29,6,27,4],[30,6,28,4],[30,10,28,8],[30,14,28,12],[30,15,28,13],[30,16,28,14,"eventViewTag"],[30,28,28,26],[30,33,28,31,"computedEventTag"],[30,49,28,47],[30,51,28,49],[31,8,29,6],[32,8,30,6,"executeForEachEventHandler"],[32,34,30,32],[32,35,30,33,"prevProps"],[32,44,30,42],[32,46,30,44],[32,47,30,45,"_key"],[32,51,30,49],[32,53,30,51,"handler"],[32,60,30,58],[32,65,30,63],[33,10,31,8,"handler"],[33,17,31,15],[33,18,31,16,"unregisterFromEvents"],[33,38,31,36],[33,39,31,37],[33,43,31,41],[33,44,31,42],[33,45,31,43,"eventViewTag"],[33,57,31,55],[33,58,31,56],[34,8,32,6],[34,9,32,7],[34,10,32,8],[35,8,33,6],[36,8,34,6],[37,8,35,6],[37,12,35,10],[37,13,35,11],[37,14,35,12,"eventViewTag"],[37,26,35,24],[37,29,35,27,"computedEventTag"],[37,45,35,43],[38,8,36,6],[39,8,37,6],[39,12,37,10],[39,13,37,11,"attachEvents"],[39,25,37,23],[39,26,37,24],[39,27,37,25],[40,8,38,6],[41,6,39,4],[42,6,40,4,"executeForEachEventHandler"],[42,32,40,30],[42,33,40,31,"prevProps"],[42,42,40,40],[42,44,40,42],[42,45,40,43,"key"],[42,48,40,46],[42,50,40,48,"prevHandler"],[42,61,40,59],[42,66,40,64],[43,8,41,6],[43,14,41,12,"newProp"],[43,21,41,19],[43,24,41,22],[43,28,41,26],[43,29,41,27],[43,30,41,28,"managedComponent"],[43,46,41,44],[43,47,41,45,"props"],[43,52,41,50],[43,53,41,51,"key"],[43,56,41,54],[43,57,41,55],[44,8,42,6],[44,12,42,10],[44,13,42,11,"newProp"],[44,20,42,18],[44,22,42,20],[45,10,43,8],[46,10,44,8,"prevHandler"],[46,21,44,19],[46,22,44,20,"unregisterFromEvents"],[46,42,44,40],[46,43,44,41],[46,47,44,45],[46,48,44,46],[46,49,44,47,"eventViewTag"],[46,61,44,59],[46,62,44,60],[47,8,45,6],[47,9,45,7],[47,15,45,13],[47,19,45,17,"isWorkletEventHandler"],[47,40,45,38],[47,41,45,39,"newProp"],[47,48,45,46],[47,49,45,47],[47,53,45,51,"newProp"],[47,60,45,58],[47,61,45,59,"workletEventHandler"],[47,80,45,78],[47,85,45,83,"prevHandler"],[47,96,45,94],[47,98,45,96],[48,10,46,8],[49,10,47,8,"prevHandler"],[49,21,47,19],[49,22,47,20,"unregisterFromEvents"],[49,42,47,40],[49,43,47,41],[49,47,47,45],[49,48,47,46],[49,49,47,47,"eventViewTag"],[49,61,47,59],[49,62,47,60],[50,10,48,8,"newProp"],[50,17,48,15],[50,18,48,16,"workletEventHandler"],[50,37,48,35],[50,38,48,36,"registerForEvents"],[50,55,48,53],[50,56,48,54],[50,60,48,58],[50,61,48,59],[50,62,48,60,"eventViewTag"],[50,74,48,72],[50,75,48,73],[51,8,49,6],[52,6,50,4],[52,7,50,5],[52,8,50,6],[53,6,51,4,"executeForEachEventHandler"],[53,32,51,30],[53,33,51,31],[53,37,51,35],[53,38,51,36],[53,39,51,37,"managedComponent"],[53,55,51,53],[53,56,51,54,"props"],[53,61,51,59],[53,63,51,61],[53,64,51,62,"key"],[53,67,51,65],[53,69,51,67,"handler"],[53,76,51,74],[53,81,51,79],[54,8,52,6],[54,12,52,10],[54,13,52,11,"prevProps"],[54,22,52,20],[54,23,52,21,"key"],[54,26,52,24],[54,27,52,25],[54,29,52,27],[55,10,53,8],[56,10,54,8,"handler"],[56,17,54,15],[56,18,54,16,"registerForEvents"],[56,35,54,33],[56,36,54,34],[56,40,54,38],[56,41,54,39],[56,42,54,40,"eventViewTag"],[56,54,54,52],[56,55,54,53],[57,8,55,6],[58,6,56,4],[58,7,56,5],[58,8,56,6],[59,4,57,2],[60,4,58,2,"getEventViewTag"],[60,19,58,17,"getEventViewTag"],[60,20,58,18,"componentUpdate"],[60,35,58,33],[60,38,58,36],[60,43,58,41],[60,45,58,43],[61,6,59,4],[62,6,60,4],[62,12,60,10,"componentAnimatedRef"],[62,32,60,30],[62,35,60,33],[62,39,60,37],[62,40,60,38],[62,41,60,39,"managedComponent"],[62,57,60,55],[62,58,60,56,"_componentRef"],[62,71,60,69],[63,6,61,4],[63,10,61,8,"componentAnimatedRef"],[63,30,61,28],[63,32,61,30,"getScrollableNode"],[63,49,61,47],[63,51,61,49],[64,8,62,6],[65,0,63,0],[66,0,64,0],[67,0,65,0],[68,0,66,0],[69,0,67,0],[70,8,68,6],[70,14,68,12,"scrollableNode"],[70,28,68,26],[70,31,68,29,"componentAnimatedRef"],[70,51,68,49],[70,52,68,50,"getScrollableNode"],[70,69,68,67],[70,70,68,68],[70,71,68,69],[71,8,69,6],[71,12,69,10],[71,19,69,17,"scrollableNode"],[71,33,69,31],[71,38,69,36],[71,46,69,44],[71,48,69,46],[72,10,70,8],[72,17,70,15,"scrollableNode"],[72,31,70,29],[73,8,71,6],[74,8,72,6],[74,15,72,13],[74,19,72,13,"findNodeHandle"],[74,45,72,13],[74,46,72,13,"findNodeHandle"],[74,99,72,27],[74,101,72,28,"scrollableNode"],[74,115,72,42],[74,116,72,43],[74,120,72,47],[74,121,72,48],[74,122,72,49],[75,6,73,4],[76,6,74,4],[76,10,74,8],[76,14,74,12],[76,15,74,13],[76,16,74,14,"componentOptions"],[76,32,74,30],[76,34,74,32,"setNativeProps"],[76,48,74,46],[76,50,74,48],[77,8,75,6],[78,8,76,6],[79,8,77,6],[79,15,77,13],[79,19,77,13,"findNodeHandle"],[79,45,77,13],[79,46,77,13,"findNodeHandle"],[79,99,77,27],[79,101,77,28],[79,105,77,32],[79,106,77,33],[79,107,77,34,"managedComponent"],[79,123,77,50],[79,124,77,51],[79,128,77,55],[79,129,77,56],[79,130,77,57],[80,6,78,4],[81,6,79,4],[81,10,79,8],[81,11,79,9,"componentUpdate"],[81,26,79,24],[81,28,79,26],[82,8,80,6],[83,8,81,6],[83,15,81,13],[83,19,81,17],[83,20,81,18],[83,21,81,19,"managedComponent"],[83,37,81,35],[83,38,81,36,"getComponentViewTag"],[83,57,81,55],[83,58,81,56],[83,59,81,57],[84,6,82,4],[85,6,83,4],[85,10,83,8,"componentAnimatedRef"],[85,30,83,28],[85,32,83,30,"__nativeTag"],[85,43,83,41],[85,47,83,45,"componentAnimatedRef"],[85,67,83,65],[85,69,83,67,"_nativeTag"],[85,79,83,77],[85,81,83,79],[86,8,84,6],[87,0,85,0],[88,0,86,0],[89,0,87,0],[90,0,88,0],[91,8,89,6],[91,15,89,13,"componentAnimatedRef"],[91,35,89,33],[91,36,89,34,"__nativeTag"],[91,47,89,45],[91,51,89,49,"componentAnimatedRef"],[91,71,89,69],[91,72,89,70,"_nativeTag"],[91,82,89,80],[91,86,89,84],[91,87,89,85],[91,88,89,86],[92,6,90,4],[93,6,91,4],[94,0,92,0],[95,0,93,0],[96,0,94,0],[97,6,95,4],[97,13,95,11],[97,17,95,11,"findNodeHandle"],[97,43,95,11],[97,44,95,11,"findNodeHandle"],[97,97,95,25],[97,99,95,26,"componentAnimatedRef"],[97,119,95,46],[97,120,95,47],[97,124,95,51],[97,125,95,52],[97,126,95,53],[98,4,96,2],[99,2,97,0],[100,2,97,1,"exports"],[100,9,97,1],[100,10,97,1,"NativeEventsManager"],[100,29,97,1],[100,32,97,1,"NativeEventsManager"],[100,51,97,1],[101,2,98,0],[101,11,98,9,"isWorkletEventHandler"],[101,32,98,30,"isWorkletEventHandler"],[101,33,98,31,"prop"],[101,37,98,35],[101,39,98,37],[102,4,99,2],[102,11,99,9],[102,15,99,9,"has"],[102,41,99,9],[102,42,99,9,"has"],[102,59,99,12],[102,61,99,13],[102,82,99,34],[102,84,99,36,"prop"],[102,88,99,40],[102,89,99,41],[102,93,99,45,"prop"],[102,97,99,49],[102,98,99,50,"workletEventHandler"],[102,117,99,69],[102,129,99,81,"WorkletEventHandler"],[102,155,99,81],[102,156,99,81,"WorkletEventHandler"],[102,204,99,100],[103,2,100,0],[104,2,101,0],[104,11,101,9,"executeForEachEventHandler"],[104,37,101,35,"executeForEachEventHandler"],[104,38,101,36,"props"],[104,43,101,41],[104,45,101,43,"callback"],[104,53,101,51],[104,55,101,53],[105,4,102,2],[105,9,102,7],[105,15,102,13,"key"],[105,18,102,16],[105,22,102,20,"props"],[105,27,102,25],[105,29,102,27],[106,6,103,4],[106,12,103,10,"prop"],[106,16,103,14],[106,19,103,17,"props"],[106,24,103,22],[106,25,103,23,"key"],[106,28,103,26],[106,29,103,27],[107,6,104,4],[107,10,104,8,"isWorkletEventHandler"],[107,31,104,29],[107,32,104,30,"prop"],[107,36,104,34],[107,37,104,35],[107,39,104,37],[108,8,105,6,"callback"],[108,16,105,14],[108,17,105,15,"key"],[108,20,105,18],[108,22,105,20,"prop"],[108,26,105,24],[108,27,105,25,"workletEventHandler"],[108,46,105,44],[108,47,105,45],[109,6,106,4],[110,4,107,2],[111,2,108,0],[112,0,108,1],[112,3]],"functionMap":{"names":["<global>","NativeEventsManager","constructor","attachEvents","executeForEachEventHandler$argument_1","detachEvents","updateEvents","getEventViewTag","isWorkletEventHandler","executeForEachEventHandler"],"mappings":"AAA;OCK;ECI;GDI;EEC;6DCC;KDE;GFC;EIC;6DDC;KCE;GJC;EKC;4CFK;OEE;0CFQ;KEU;6DFC;KEK;GLC;EMC;GNsC;CDC;AQC;CRE;ASC;CTO"}},"type":"js/module"}]}