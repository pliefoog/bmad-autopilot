{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Image","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"h9Yjx6LR7umCdPP226caWyLdUPo=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/NativeModules","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"MRft9soElPgDBIQyAww27iefYeU=","exportNames":["*"],"imports":1}},{"name":"./Socket","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":110},"end":{"line":5,"column":30,"index":140}}],"key":"cfgE9Yw/a8X/959IwBnhH3A68To=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n  var _Image = _interopRequireDefault(require(_dependencyMap[1], \"react-native-web/dist/exports/Image\"));\n  var _NativeModules = _interopRequireDefault(require(_dependencyMap[2], \"react-native-web/dist/exports/NativeModules\"));\n  var _Socket = _interopRequireDefault(require(_dependencyMap[3], \"./Socket\"));\n  const Sockets = _NativeModules.default.TcpSockets;\n  /**\n   * @typedef {object} TLSSocketOptions\n   * @property {any} [ca]\n   * @property {any} [key]\n   * @property {any} [cert]\n   * @property {string} [androidKeyStore]\n   * @property {string} [certAlias]\n   * @property {string} [keyAlias]\n   * @property {string[]} [resolvedKeys]\n   *\n   * @extends {Socket}\n   */\n  class TLSSocket extends _Socket.default {\n    /**\n     * @param {Socket} socket Any instance of `Socket`.\n     * @param {TLSSocketOptions} [options] Options for the TLS socket.\n     */\n    constructor(socket, options = {}) {\n      super();\n      /** @private */\n      this._options = {\n        ...options\n      };\n      TLSSocket.resolveAssetIfNeeded(this._options, 'ca');\n      TLSSocket.resolveAssetIfNeeded(this._options, 'key');\n      TLSSocket.resolveAssetIfNeeded(this._options, 'cert');\n\n      /** @private */\n      this._socket = socket;\n      // @ts-ignore\n      this._setId(this._socket._id);\n      this._startTLS();\n      if (socket.pending || socket.connecting) socket.once('connect', () => this._initialize());else this._initialize();\n    }\n\n    /**\n     * @private\n     */\n    _initialize() {\n      // Avoid calling twice destroy() if an error occurs\n      this._socket._errorListener?.remove();\n      this.on('error', error => this._socket.emit('error', error));\n      this._setConnected({\n        // @ts-ignore\n        localAddress: this._socket.localAddress,\n        // @ts-ignore\n        localPort: this._socket.localPort,\n        // @ts-ignore\n        remoteAddress: this._socket.remoteAddress,\n        // @ts-ignore\n        remotePort: this._socket.remotePort,\n        // @ts-ignore\n        remoteFamily: this._socket.remoteFamily\n      });\n    }\n\n    /**\n     * @private\n     */\n    _startTLS() {\n      Sockets.startTLS(this._id, this._options);\n    }\n\n    /**\n     * Checks if a certificate identity exists in the keychain\n     * @param {object} options Object containing the identity aliases\n     * @param {string} [options.androidKeyStore] The android keystore type\n     * @param {string} [options.certAlias] The certificate alias\n     * @param {string} [options.keyAlias] The key alias\n     * @returns {Promise<boolean>} Promise resolving to true if identity exists\n     */\n    static hasIdentity(options = {}) {\n      return Sockets.hasIdentity({\n        androidKeyStore: options.androidKeyStore,\n        certAlias: options.certAlias,\n        keyAlias: options.keyAlias\n      });\n    }\n    getCertificate() {\n      return Sockets.getCertificate(this._id);\n    }\n    getPeerCertificate() {\n      return Sockets.getPeerCertificate(this._id);\n    }\n\n    /**\n     * @private\n     * Resolves the asset source if necessary and registers the resolved key.\n     * @param {TLSSocketOptions} options The options object containing the source to be resolved.\n     * @param {'ca' | 'key' | 'cert'} key The key name being resolved.\n     */\n    static resolveAssetIfNeeded(options, key) {\n      const source = options[key];\n      if (source && typeof source !== 'string') {\n        if (!options.resolvedKeys) {\n          options.resolvedKeys = [];\n        }\n        options.resolvedKeys.push(key);\n        options[key] = _Image.default.resolveAssetSource(source).uri;\n      }\n    }\n  }\n  exports.default = TLSSocket;\n});","lineCount":116,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13],[4,6,1,13,"_interopRequireDefault"],[4,28,1,13],[4,31,1,13,"require"],[4,38,1,13],[4,39,1,13,"_dependencyMap"],[4,53,1,13],[5,2,1,13,"Object"],[5,8,1,13],[5,9,1,13,"defineProperty"],[5,23,1,13],[5,24,1,13,"exports"],[5,31,1,13],[6,4,1,13,"value"],[6,9,1,13],[7,2,1,13],[8,2,1,13,"exports"],[8,9,1,13],[8,10,1,13,"default"],[8,17,1,13],[9,2,1,13],[9,6,1,13,"_Image"],[9,12,1,13],[9,15,1,13,"_interopRequireDefault"],[9,37,1,13],[9,38,1,13,"require"],[9,45,1,13],[9,46,1,13,"_dependencyMap"],[9,60,1,13],[10,2,1,13],[10,6,1,13,"_NativeModules"],[10,20,1,13],[10,23,1,13,"_interopRequireDefault"],[10,45,1,13],[10,46,1,13,"require"],[10,53,1,13],[10,54,1,13,"_dependencyMap"],[10,68,1,13],[11,2,5,0],[11,6,5,0,"_Socket"],[11,13,5,0],[11,16,5,0,"_interopRequireDefault"],[11,38,5,0],[11,39,5,0,"require"],[11,46,5,0],[11,47,5,0,"_dependencyMap"],[11,61,5,0],[12,2,4,0],[12,8,4,6,"Sockets"],[12,15,4,13],[12,18,4,16,"NativeModules"],[12,40,4,29],[12,41,4,30,"TcpSockets"],[12,51,4,40],[13,2,7,0],[14,0,8,0],[15,0,9,0],[16,0,10,0],[17,0,11,0],[18,0,12,0],[19,0,13,0],[20,0,14,0],[21,0,15,0],[22,0,16,0],[23,0,17,0],[24,0,18,0],[25,2,19,15],[25,8,19,21,"TLSSocket"],[25,17,19,30],[25,26,19,39,"Socket"],[25,41,19,45],[25,42,19,46],[26,4,20,4],[27,0,21,0],[28,0,22,0],[29,0,23,0],[30,4,24,4,"constructor"],[30,15,24,15,"constructor"],[30,16,24,16,"socket"],[30,22,24,22],[30,24,24,24,"options"],[30,31,24,31],[30,34,24,34],[30,35,24,35],[30,36,24,36],[30,38,24,38],[31,6,25,8],[31,11,25,13],[31,12,25,14],[31,13,25,15],[32,6,26,8],[33,6,27,8],[33,10,27,12],[33,11,27,13,"_options"],[33,19,27,21],[33,22,27,24],[34,8,27,26],[34,11,27,29,"options"],[35,6,27,37],[35,7,27,38],[36,6,28,8,"TLSSocket"],[36,15,28,17],[36,16,28,18,"resolveAssetIfNeeded"],[36,36,28,38],[36,37,28,39],[36,41,28,43],[36,42,28,44,"_options"],[36,50,28,52],[36,52,28,54],[36,56,28,58],[36,57,28,59],[37,6,29,8,"TLSSocket"],[37,15,29,17],[37,16,29,18,"resolveAssetIfNeeded"],[37,36,29,38],[37,37,29,39],[37,41,29,43],[37,42,29,44,"_options"],[37,50,29,52],[37,52,29,54],[37,57,29,59],[37,58,29,60],[38,6,30,8,"TLSSocket"],[38,15,30,17],[38,16,30,18,"resolveAssetIfNeeded"],[38,36,30,38],[38,37,30,39],[38,41,30,43],[38,42,30,44,"_options"],[38,50,30,52],[38,52,30,54],[38,58,30,60],[38,59,30,61],[40,6,32,8],[41,6,33,8],[41,10,33,12],[41,11,33,13,"_socket"],[41,18,33,20],[41,21,33,23,"socket"],[41,27,33,29],[42,6,34,8],[43,6,35,8],[43,10,35,12],[43,11,35,13,"_setId"],[43,17,35,19],[43,18,35,20],[43,22,35,24],[43,23,35,25,"_socket"],[43,30,35,32],[43,31,35,33,"_id"],[43,34,35,36],[43,35,35,37],[44,6,36,8],[44,10,36,12],[44,11,36,13,"_startTLS"],[44,20,36,22],[44,21,36,23],[44,22,36,24],[45,6,37,8],[45,10,37,12,"socket"],[45,16,37,18],[45,17,37,19,"pending"],[45,24,37,26],[45,28,37,30,"socket"],[45,34,37,36],[45,35,37,37,"connecting"],[45,45,37,47],[45,47,37,49,"socket"],[45,53,37,55],[45,54,37,56,"once"],[45,58,37,60],[45,59,37,61],[45,68,37,70],[45,70,37,72],[45,76,37,78],[45,80,37,82],[45,81,37,83,"_initialize"],[45,92,37,94],[45,93,37,95],[45,94,37,96],[45,95,37,97],[45,96,37,98],[45,101,38,13],[45,105,38,17],[45,106,38,18,"_initialize"],[45,117,38,29],[45,118,38,30],[45,119,38,31],[46,4,39,4],[48,4,41,4],[49,0,42,0],[50,0,43,0],[51,4,44,4,"_initialize"],[51,15,44,15,"_initialize"],[51,16,44,15],[51,18,44,18],[52,6,45,8],[53,6,46,8],[53,10,46,12],[53,11,46,13,"_socket"],[53,18,46,20],[53,19,46,21,"_errorListener"],[53,33,46,35],[53,35,46,37,"remove"],[53,41,46,43],[53,42,46,44],[53,43,46,45],[54,6,47,8],[54,10,47,12],[54,11,47,13,"on"],[54,13,47,15],[54,14,47,16],[54,21,47,23],[54,23,47,26,"error"],[54,28,47,31],[54,32,47,36],[54,36,47,40],[54,37,47,41,"_socket"],[54,44,47,48],[54,45,47,49,"emit"],[54,49,47,53],[54,50,47,54],[54,57,47,61],[54,59,47,63,"error"],[54,64,47,68],[54,65,47,69],[54,66,47,70],[55,6,48,8],[55,10,48,12],[55,11,48,13,"_setConnected"],[55,24,48,26],[55,25,48,27],[56,8,49,12],[57,8,50,12,"localAddress"],[57,20,50,24],[57,22,50,26],[57,26,50,30],[57,27,50,31,"_socket"],[57,34,50,38],[57,35,50,39,"localAddress"],[57,47,50,51],[58,8,51,12],[59,8,52,12,"localPort"],[59,17,52,21],[59,19,52,23],[59,23,52,27],[59,24,52,28,"_socket"],[59,31,52,35],[59,32,52,36,"localPort"],[59,41,52,45],[60,8,53,12],[61,8,54,12,"remoteAddress"],[61,21,54,25],[61,23,54,27],[61,27,54,31],[61,28,54,32,"_socket"],[61,35,54,39],[61,36,54,40,"remoteAddress"],[61,49,54,53],[62,8,55,12],[63,8,56,12,"remotePort"],[63,18,56,22],[63,20,56,24],[63,24,56,28],[63,25,56,29,"_socket"],[63,32,56,36],[63,33,56,37,"remotePort"],[63,43,56,47],[64,8,57,12],[65,8,58,12,"remoteFamily"],[65,20,58,24],[65,22,58,26],[65,26,58,30],[65,27,58,31,"_socket"],[65,34,58,38],[65,35,58,39,"remoteFamily"],[66,6,59,8],[66,7,59,9],[66,8,59,10],[67,4,60,4],[69,4,62,4],[70,0,63,0],[71,0,64,0],[72,4,65,4,"_startTLS"],[72,13,65,13,"_startTLS"],[72,14,65,13],[72,16,65,16],[73,6,66,8,"Sockets"],[73,13,66,15],[73,14,66,16,"startTLS"],[73,22,66,24],[73,23,66,25],[73,27,66,29],[73,28,66,30,"_id"],[73,31,66,33],[73,33,66,35],[73,37,66,39],[73,38,66,40,"_options"],[73,46,66,48],[73,47,66,49],[74,4,67,4],[76,4,69,4],[77,0,70,0],[78,0,71,0],[79,0,72,0],[80,0,73,0],[81,0,74,0],[82,0,75,0],[83,0,76,0],[84,4,77,4],[84,11,77,11,"hasIdentity"],[84,22,77,22,"hasIdentity"],[84,23,77,23,"options"],[84,30,77,30],[84,33,77,33],[84,34,77,34],[84,35,77,35],[84,37,77,37],[85,6,78,8],[85,13,78,15,"Sockets"],[85,20,78,22],[85,21,78,23,"hasIdentity"],[85,32,78,34],[85,33,78,35],[86,8,79,12,"androidKeyStore"],[86,23,79,27],[86,25,79,29,"options"],[86,32,79,36],[86,33,79,37,"androidKeyStore"],[86,48,79,52],[87,8,80,12,"certAlias"],[87,17,80,21],[87,19,80,23,"options"],[87,26,80,30],[87,27,80,31,"certAlias"],[87,36,80,40],[88,8,81,12,"keyAlias"],[88,16,81,20],[88,18,81,22,"options"],[88,25,81,29],[88,26,81,30,"keyAlias"],[89,6,82,8],[89,7,82,9],[89,8,82,10],[90,4,83,4],[91,4,85,4,"getCertificate"],[91,18,85,18,"getCertificate"],[91,19,85,18],[91,21,85,21],[92,6,86,8],[92,13,86,15,"Sockets"],[92,20,86,22],[92,21,86,23,"getCertificate"],[92,35,86,37],[92,36,86,38],[92,40,86,42],[92,41,86,43,"_id"],[92,44,86,46],[92,45,86,47],[93,4,87,4],[94,4,89,4,"getPeerCertificate"],[94,22,89,22,"getPeerCertificate"],[94,23,89,22],[94,25,89,25],[95,6,90,8],[95,13,90,15,"Sockets"],[95,20,90,22],[95,21,90,23,"getPeerCertificate"],[95,39,90,41],[95,40,90,42],[95,44,90,46],[95,45,90,47,"_id"],[95,48,90,50],[95,49,90,51],[96,4,91,4],[98,4,93,4],[99,0,94,0],[100,0,95,0],[101,0,96,0],[102,0,97,0],[103,0,98,0],[104,4,99,4],[104,11,99,11,"resolveAssetIfNeeded"],[104,31,99,31,"resolveAssetIfNeeded"],[104,32,99,32,"options"],[104,39,99,39],[104,41,99,41,"key"],[104,44,99,44],[104,46,99,46],[105,6,100,8],[105,12,100,14,"source"],[105,18,100,20],[105,21,100,23,"options"],[105,28,100,30],[105,29,100,31,"key"],[105,32,100,34],[105,33,100,35],[106,6,101,8],[106,10,101,12,"source"],[106,16,101,18],[106,20,101,22],[106,27,101,29,"source"],[106,33,101,35],[106,38,101,40],[106,46,101,48],[106,48,101,50],[107,8,102,12],[107,12,102,16],[107,13,102,17,"options"],[107,20,102,24],[107,21,102,25,"resolvedKeys"],[107,33,102,37],[107,35,102,39],[108,10,103,16,"options"],[108,17,103,23],[108,18,103,24,"resolvedKeys"],[108,30,103,36],[108,33,103,39],[108,35,103,41],[109,8,104,12],[110,8,105,12,"options"],[110,15,105,19],[110,16,105,20,"resolvedKeys"],[110,28,105,32],[110,29,105,33,"push"],[110,33,105,37],[110,34,105,38,"key"],[110,37,105,41],[110,38,105,42],[111,8,106,12,"options"],[111,15,106,19],[111,16,106,20,"key"],[111,19,106,23],[111,20,106,24],[111,23,106,27,"Image"],[111,37,106,32],[111,38,106,33,"resolveAssetSource"],[111,56,106,51],[111,57,106,52,"source"],[111,63,106,58],[111,64,106,59],[111,65,106,60,"uri"],[111,68,106,63],[112,6,107,8],[113,4,108,4],[114,2,109,0],[115,2,109,1,"exports"],[115,9,109,1],[115,10,109,1,"default"],[115,17,109,1],[115,20,109,1,"TLSSocket"],[115,29,109,1],[116,0,109,1],[116,3]],"functionMap":{"names":["<global>","TLSSocket","constructor","socket.once$argument_1","_initialize","on$argument_1","_startTLS","hasIdentity","getCertificate","getPeerCertificate","resolveAssetIfNeeded"],"mappings":"AAA;eCkB;ICK;wECa,wBD;KDE;IGK;yBCG,4CD;KHa;IKK;KLE;IMU;KNM;IOE;KPE;IQE;KRE;ISQ;KTS;CDC"}},"type":"js/module"}]}