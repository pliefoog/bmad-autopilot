{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Image","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"h9Yjx6LR7umCdPP226caWyLdUPo=","exportNames":["*"],"imports":1}},{"name":"./Server","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":53},"end":{"line":4,"column":30,"index":83}}],"key":"9sCYoHHemTc9PQk/ZqBB2lH9kmU=","exportNames":["*"],"imports":1}},{"name":"./TLSSocket","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":84},"end":{"line":5,"column":36,"index":120}}],"key":"j+SqCPeiy8nx9kYIyTVdQ4Gosfs=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n  var _Image = _interopRequireDefault(require(_dependencyMap[1], \"react-native-web/dist/exports/Image\"));\n  var _Server = _interopRequireDefault(require(_dependencyMap[2], \"./Server\"));\n  var _TLSSocket = _interopRequireDefault(require(_dependencyMap[3], \"./TLSSocket\"));\n  /**\n   * @typedef {object} TLSServerOptions\n   * @property {any} keystore\n   *\n   * @extends {Server}\n   */\n  class TLSServer extends _Server.default {\n    /**\n     * @param {(socket: TLSSocket) => void} [secureConnectionListener] Automatically set as a listener for the `'secureConnection'` event.\n     */\n    constructor(secureConnectionListener) {\n      super();\n      if (secureConnectionListener) this.on('secureConnection', secureConnectionListener);\n      this._registerTLSEvents();\n    }\n\n    /**\n     * @param {TLSServerOptions} options TLS server options\n     */\n    setSecureContext(options) {\n      /** @private */\n      this._options = {\n        ...options\n      };\n      this._options.keystore = _Image.default.resolveAssetSource(this._options.keystore).uri;\n    }\n\n    /**\n     * Start a server listening for connections.\n     *\n     * This function is asynchronous. When the server starts listening, the `'listening'` event will be emitted.\n     * The last parameter `callback` will be added as a listener for the `'listening'` event.\n     *\n     * The `server.listen()` method can be called again if and only if there was an error during the first\n     * `server.listen()` call or `server.close()` has been called. Otherwise, an `ERR_SERVER_ALREADY_LISTEN`\n     * error will be thrown.\n     *\n     * @param {{ port: number; host: string; reuseAddress?: boolean}} options\n     * @param {() => void} [callback]\n     * @override\n     */\n    listen(options, callback) {\n      const newOptions = {\n        ...options\n      };\n      // @ts-ignore\n      newOptions['tls'] = this._options;\n      return super.listen(newOptions, callback);\n    }\n\n    /**\n     * @private\n     */\n    _registerTLSEvents() {\n      this._secureConnectionListener = this._eventEmitter.addListener('secureConnection', evt => {\n        if (evt.id !== this._id) return;\n        const standardSocket = this._buildSocket(evt.info);\n        standardSocket._unregisterEvents();\n        const tlsSocket = new _TLSSocket.default(standardSocket);\n        this._addConnection(tlsSocket);\n        this.emit('connection', standardSocket);\n        this.emit('secureConnection', tlsSocket);\n      });\n    }\n  }\n  exports.default = TLSServer;\n});","lineCount":78,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13],[4,6,1,13,"_interopRequireDefault"],[4,28,1,13],[4,31,1,13,"require"],[4,38,1,13],[4,39,1,13,"_dependencyMap"],[4,53,1,13],[5,2,1,13,"Object"],[5,8,1,13],[5,9,1,13,"defineProperty"],[5,23,1,13],[5,24,1,13,"exports"],[5,31,1,13],[6,4,1,13,"value"],[6,9,1,13],[7,2,1,13],[8,2,1,13,"exports"],[8,9,1,13],[8,10,1,13,"default"],[8,17,1,13],[9,2,1,13],[9,6,1,13,"_Image"],[9,12,1,13],[9,15,1,13,"_interopRequireDefault"],[9,37,1,13],[9,38,1,13,"require"],[9,45,1,13],[9,46,1,13,"_dependencyMap"],[9,60,1,13],[10,2,4,0],[10,6,4,0,"_Server"],[10,13,4,0],[10,16,4,0,"_interopRequireDefault"],[10,38,4,0],[10,39,4,0,"require"],[10,46,4,0],[10,47,4,0,"_dependencyMap"],[10,61,4,0],[11,2,5,0],[11,6,5,0,"_TLSSocket"],[11,16,5,0],[11,19,5,0,"_interopRequireDefault"],[11,41,5,0],[11,42,5,0,"require"],[11,49,5,0],[11,50,5,0,"_dependencyMap"],[11,64,5,0],[12,2,7,0],[13,0,8,0],[14,0,9,0],[15,0,10,0],[16,0,11,0],[17,0,12,0],[18,2,13,15],[18,8,13,21,"TLSServer"],[18,17,13,30],[18,26,13,39,"Server"],[18,41,13,45],[18,42,13,46],[19,4,14,4],[20,0,15,0],[21,0,16,0],[22,4,17,4,"constructor"],[22,15,17,15,"constructor"],[22,16,17,16,"secureConnectionListener"],[22,40,17,40],[22,42,17,42],[23,6,18,8],[23,11,18,13],[23,12,18,14],[23,13,18,15],[24,6,19,8],[24,10,19,12,"secureConnectionListener"],[24,34,19,36],[24,36,19,38],[24,40,19,42],[24,41,19,43,"on"],[24,43,19,45],[24,44,19,46],[24,62,19,64],[24,64,19,66,"secureConnectionListener"],[24,88,19,90],[24,89,19,91],[25,6,20,8],[25,10,20,12],[25,11,20,13,"_registerTLSEvents"],[25,29,20,31],[25,30,20,32],[25,31,20,33],[26,4,21,4],[28,4,23,4],[29,0,24,0],[30,0,25,0],[31,4,26,4,"setSecureContext"],[31,20,26,20,"setSecureContext"],[31,21,26,21,"options"],[31,28,26,28],[31,30,26,30],[32,6,27,8],[33,6,28,8],[33,10,28,12],[33,11,28,13,"_options"],[33,19,28,21],[33,22,28,24],[34,8,28,26],[34,11,28,29,"options"],[35,6,28,37],[35,7,28,38],[36,6,29,8],[36,10,29,12],[36,11,29,13,"_options"],[36,19,29,21],[36,20,29,22,"keystore"],[36,28,29,30],[36,31,29,33,"Image"],[36,45,29,38],[36,46,29,39,"resolveAssetSource"],[36,64,29,57],[36,65,29,58],[36,69,29,62],[36,70,29,63,"_options"],[36,78,29,71],[36,79,29,72,"keystore"],[36,87,29,80],[36,88,29,81],[36,89,29,82,"uri"],[36,92,29,85],[37,4,30,4],[39,4,32,4],[40,0,33,0],[41,0,34,0],[42,0,35,0],[43,0,36,0],[44,0,37,0],[45,0,38,0],[46,0,39,0],[47,0,40,0],[48,0,41,0],[49,0,42,0],[50,0,43,0],[51,0,44,0],[52,0,45,0],[53,4,46,4,"listen"],[53,10,46,10,"listen"],[53,11,46,11,"options"],[53,18,46,18],[53,20,46,20,"callback"],[53,28,46,28],[53,30,46,30],[54,6,47,8],[54,12,47,14,"newOptions"],[54,22,47,24],[54,25,47,27],[55,8,47,29],[55,11,47,32,"options"],[56,6,47,40],[56,7,47,41],[57,6,48,8],[58,6,49,8,"newOptions"],[58,16,49,18],[58,17,49,19],[58,22,49,24],[58,23,49,25],[58,26,49,28],[58,30,49,32],[58,31,49,33,"_options"],[58,39,49,41],[59,6,50,8],[59,13,50,15],[59,18,50,20],[59,19,50,21,"listen"],[59,25,50,27],[59,26,50,28,"newOptions"],[59,36,50,38],[59,38,50,40,"callback"],[59,46,50,48],[59,47,50,49],[60,4,51,4],[62,4,53,4],[63,0,54,0],[64,0,55,0],[65,4,56,4,"_registerTLSEvents"],[65,22,56,22,"_registerTLSEvents"],[65,23,56,22],[65,25,56,25],[66,6,57,8],[66,10,57,12],[66,11,57,13,"_secureConnectionListener"],[66,36,57,38],[66,39,57,41],[66,43,57,45],[66,44,57,46,"_eventEmitter"],[66,57,57,59],[66,58,57,60,"addListener"],[66,69,57,71],[66,70,58,12],[66,88,58,30],[66,90,59,13,"evt"],[66,93,59,16],[66,97,59,21],[67,8,60,16],[67,12,60,20,"evt"],[67,15,60,23],[67,16,60,24,"id"],[67,18,60,26],[67,23,60,31],[67,27,60,35],[67,28,60,36,"_id"],[67,31,60,39],[67,33,60,41],[68,8,61,16],[68,14,61,22,"standardSocket"],[68,28,61,36],[68,31,61,39],[68,35,61,43],[68,36,61,44,"_buildSocket"],[68,48,61,56],[68,49,61,57,"evt"],[68,52,61,60],[68,53,61,61,"info"],[68,57,61,65],[68,58,61,66],[69,8,62,16,"standardSocket"],[69,22,62,30],[69,23,62,31,"_unregisterEvents"],[69,40,62,48],[69,41,62,49],[69,42,62,50],[70,8,63,16],[70,14,63,22,"tlsSocket"],[70,23,63,31],[70,26,63,34],[70,30,63,38,"TLSSocket"],[70,48,63,47],[70,49,63,48,"standardSocket"],[70,63,63,62],[70,64,63,63],[71,8,64,16],[71,12,64,20],[71,13,64,21,"_addConnection"],[71,27,64,35],[71,28,64,36,"tlsSocket"],[71,37,64,45],[71,38,64,46],[72,8,65,16],[72,12,65,20],[72,13,65,21,"emit"],[72,17,65,25],[72,18,65,26],[72,30,65,38],[72,32,65,40,"standardSocket"],[72,46,65,54],[72,47,65,55],[73,8,66,16],[73,12,66,20],[73,13,66,21,"emit"],[73,17,66,25],[73,18,66,26],[73,36,66,44],[73,38,66,46,"tlsSocket"],[73,47,66,55],[73,48,66,56],[74,6,67,12],[74,7,68,8],[74,8,68,9],[75,4,69,4],[76,2,70,0],[77,2,70,1,"exports"],[77,9,70,1],[77,10,70,1,"default"],[77,17,70,1],[77,20,70,1,"TLSServer"],[77,29,70,1],[78,0,70,1],[78,3]],"functionMap":{"names":["<global>","TLSServer","constructor","setSecureContext","listen","_registerTLSEvents","_eventEmitter.addListener$argument_1"],"mappings":"AAA;eCY;ICI;KDI;IEK;KFI;IGgB;KHK;IIK;YCG;aDQ;KJE;CDC"}},"type":"js/module"}]}