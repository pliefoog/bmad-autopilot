{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireWildcard","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"fGo7mEc/tw/OblLqGBCp3J3h+jY=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":31,"index":46}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"./NavigationBuilderContext.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":47},"end":{"line":4,"column":73,"index":120}}],"key":"vvb+tbs8cGp9hlTxgL5PZCjRz5E=","exportNames":["*"],"imports":1}},{"name":"./NavigationRouteContext.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":121},"end":{"line":5,"column":69,"index":190}}],"key":"AWXnpGNA5UkH1qQUM7hLv2L9KzI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _interopRequireWildcard = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireWildcard\").default;\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.shouldPreventRemove = void 0;\n  exports.useOnPreventRemove = useOnPreventRemove;\n  var React = _interopRequireWildcard(require(_dependencyMap[1], \"react\"));\n  var VISITED_ROUTE_KEYS = Symbol('VISITED_ROUTE_KEYS');\n  var shouldPreventRemove = (emitter, beforeRemoveListeners, currentRoutes, nextRoutes, action) => {\n    var nextRouteKeys = nextRoutes.map(route => route.key);\n\n    // Call these in reverse order so last screens handle the event first\n    var removedRoutes = currentRoutes.filter(route => !nextRouteKeys.includes(route.key)).reverse();\n    var visitedRouteKeys =\n    // @ts-expect-error: add this property to mark that we've already emitted this action\n    action[VISITED_ROUTE_KEYS] ?? new Set();\n    var beforeRemoveAction = {\n      ...action,\n      [VISITED_ROUTE_KEYS]: visitedRouteKeys\n    };\n    for (var route of removedRoutes) {\n      if (visitedRouteKeys.has(route.key)) {\n        // Skip if we've already emitted this action for this screen\n        continue;\n      }\n\n      // First, we need to check if any child screens want to prevent it\n      var isPrevented = beforeRemoveListeners[route.key]?.(beforeRemoveAction);\n      if (isPrevented) {\n        return true;\n      }\n      visitedRouteKeys.add(route.key);\n      var event = emitter.emit({\n        type: 'beforeRemove',\n        target: route.key,\n        data: {\n          action: beforeRemoveAction\n        },\n        canPreventDefault: true\n      });\n      if (event.defaultPrevented) {\n        return true;\n      }\n    }\n    return false;\n  };\n  exports.shouldPreventRemove = shouldPreventRemove;\n  function useOnPreventRemove(_ref) {\n    var getState = _ref.getState,\n      emitter = _ref.emitter,\n      beforeRemoveListeners = _ref.beforeRemoveListeners;\n    var _React$useContext = React.useContext(require(_dependencyMap[2], \"./NavigationBuilderContext.js\").NavigationBuilderContext),\n      addKeyedListener = _React$useContext.addKeyedListener;\n    var route = React.useContext(require(_dependencyMap[3], \"./NavigationRouteContext.js\").NavigationRouteContext);\n    var routeKey = route?.key;\n    React.useEffect(() => {\n      if (routeKey) {\n        return addKeyedListener?.('beforeRemove', routeKey, action => {\n          var state = getState();\n          return shouldPreventRemove(emitter, beforeRemoveListeners, state.routes, [], action);\n        });\n      }\n    }, [addKeyedListener, beforeRemoveListeners, emitter, getState, routeKey]);\n  }\n});","lineCount":68,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13],[4,6,1,13,"_interopRequireWildcard"],[4,29,1,13],[4,32,1,13,"require"],[4,39,1,13],[4,40,1,13,"_dependencyMap"],[4,54,1,13],[4,108,1,13,"default"],[4,115,1,13],[5,2,1,13,"Object"],[5,8,1,13],[5,9,1,13,"defineProperty"],[5,23,1,13],[5,24,1,13,"exports"],[5,31,1,13],[6,4,1,13,"value"],[6,9,1,13],[7,2,1,13],[8,2,1,13,"exports"],[8,9,1,13],[8,10,1,13,"shouldPreventRemove"],[8,29,1,13],[9,2,1,13,"exports"],[9,9,1,13],[9,10,1,13,"useOnPreventRemove"],[9,28,1,13],[9,31,1,13,"useOnPreventRemove"],[9,49,1,13],[10,2,3,0],[10,6,3,0,"React"],[10,11,3,0],[10,14,3,0,"_interopRequireWildcard"],[10,37,3,0],[10,38,3,0,"require"],[10,45,3,0],[10,46,3,0,"_dependencyMap"],[10,60,3,0],[11,2,6,0],[11,6,6,6,"VISITED_ROUTE_KEYS"],[11,24,6,24],[11,27,6,27,"Symbol"],[11,33,6,33],[11,34,6,34],[11,54,6,54],[11,55,6,55],[12,2,7,7],[12,6,7,13,"shouldPreventRemove"],[12,25,7,32],[12,28,7,35,"shouldPreventRemove"],[12,29,7,36,"emitter"],[12,36,7,43],[12,38,7,45,"beforeRemoveListeners"],[12,59,7,66],[12,61,7,68,"currentRoutes"],[12,74,7,81],[12,76,7,83,"nextRoutes"],[12,86,7,93],[12,88,7,95,"action"],[12,94,7,101],[12,99,7,106],[13,4,8,2],[13,8,8,8,"nextRouteKeys"],[13,21,8,21],[13,24,8,24,"nextRoutes"],[13,34,8,34],[13,35,8,35,"map"],[13,38,8,38],[13,39,8,39,"route"],[13,44,8,44],[13,48,8,48,"route"],[13,53,8,53],[13,54,8,54,"key"],[13,57,8,57],[13,58,8,58],[15,4,10,2],[16,4,11,2],[16,8,11,8,"removedRoutes"],[16,21,11,21],[16,24,11,24,"currentRoutes"],[16,37,11,37],[16,38,11,38,"filter"],[16,44,11,44],[16,45,11,45,"route"],[16,50,11,50],[16,54,11,54],[16,55,11,55,"nextRouteKeys"],[16,68,11,68],[16,69,11,69,"includes"],[16,77,11,77],[16,78,11,78,"route"],[16,83,11,83],[16,84,11,84,"key"],[16,87,11,87],[16,88,11,88],[16,89,11,89],[16,90,11,90,"reverse"],[16,97,11,97],[16,98,11,98],[16,99,11,99],[17,4,12,2],[17,8,12,8,"visitedRouteKeys"],[17,24,12,24],[18,4,13,2],[19,4,14,2,"action"],[19,10,14,8],[19,11,14,9,"VISITED_ROUTE_KEYS"],[19,29,14,27],[19,30,14,28],[19,34,14,32],[19,38,14,36,"Set"],[19,41,14,39],[19,42,14,40],[19,43,14,41],[20,4,15,2],[20,8,15,8,"beforeRemoveAction"],[20,26,15,26],[20,29,15,29],[21,6,16,4],[21,9,16,7,"action"],[21,15,16,13],[22,6,17,4],[22,7,17,5,"VISITED_ROUTE_KEYS"],[22,25,17,23],[22,28,17,26,"visitedRouteKeys"],[23,4,18,2],[23,5,18,3],[24,4,19,2],[24,9,19,7],[24,13,19,13,"route"],[24,18,19,18],[24,22,19,22,"removedRoutes"],[24,35,19,35],[24,37,19,37],[25,6,20,4],[25,10,20,8,"visitedRouteKeys"],[25,26,20,24],[25,27,20,25,"has"],[25,30,20,28],[25,31,20,29,"route"],[25,36,20,34],[25,37,20,35,"key"],[25,40,20,38],[25,41,20,39],[25,43,20,41],[26,8,21,6],[27,8,22,6],[28,6,23,4],[30,6,25,4],[31,6,26,4],[31,10,26,10,"isPrevented"],[31,21,26,21],[31,24,26,24,"beforeRemoveListeners"],[31,45,26,45],[31,46,26,46,"route"],[31,51,26,51],[31,52,26,52,"key"],[31,55,26,55],[31,56,26,56],[31,59,26,59,"beforeRemoveAction"],[31,77,26,77],[31,78,26,78],[32,6,27,4],[32,10,27,8,"isPrevented"],[32,21,27,19],[32,23,27,21],[33,8,28,6],[33,15,28,13],[33,19,28,17],[34,6,29,4],[35,6,30,4,"visitedRouteKeys"],[35,22,30,20],[35,23,30,21,"add"],[35,26,30,24],[35,27,30,25,"route"],[35,32,30,30],[35,33,30,31,"key"],[35,36,30,34],[35,37,30,35],[36,6,31,4],[36,10,31,10,"event"],[36,15,31,15],[36,18,31,18,"emitter"],[36,25,31,25],[36,26,31,26,"emit"],[36,30,31,30],[36,31,31,31],[37,8,32,6,"type"],[37,12,32,10],[37,14,32,12],[37,28,32,26],[38,8,33,6,"target"],[38,14,33,12],[38,16,33,14,"route"],[38,21,33,19],[38,22,33,20,"key"],[38,25,33,23],[39,8,34,6,"data"],[39,12,34,10],[39,14,34,12],[40,10,35,8,"action"],[40,16,35,14],[40,18,35,16,"beforeRemoveAction"],[41,8,36,6],[41,9,36,7],[42,8,37,6,"canPreventDefault"],[42,25,37,23],[42,27,37,25],[43,6,38,4],[43,7,38,5],[43,8,38,6],[44,6,39,4],[44,10,39,8,"event"],[44,15,39,13],[44,16,39,14,"defaultPrevented"],[44,32,39,30],[44,34,39,32],[45,8,40,6],[45,15,40,13],[45,19,40,17],[46,6,41,4],[47,4,42,2],[48,4,43,2],[48,11,43,9],[48,16,43,14],[49,2,44,0],[49,3,44,1],[50,2,44,2,"exports"],[50,9,44,2],[50,10,44,2,"shouldPreventRemove"],[50,29,44,2],[50,32,44,2,"shouldPreventRemove"],[50,51,44,2],[51,2,45,7],[51,11,45,16,"useOnPreventRemove"],[51,29,45,34,"useOnPreventRemove"],[51,30,45,34,"_ref"],[51,34,45,34],[51,36,49,3],[52,4,49,3],[52,8,46,2,"getState"],[52,16,46,10],[52,19,46,10,"_ref"],[52,23,46,10],[52,24,46,2,"getState"],[52,32,46,10],[53,6,47,2,"emitter"],[53,13,47,9],[53,16,47,9,"_ref"],[53,20,47,9],[53,21,47,2,"emitter"],[53,28,47,9],[54,6,48,2,"beforeRemoveListeners"],[54,27,48,23],[54,30,48,23,"_ref"],[54,34,48,23],[54,35,48,2,"beforeRemoveListeners"],[54,56,48,23],[55,4,50,2],[55,8,50,2,"_React$useContext"],[55,25,50,2],[55,28,52,6,"React"],[55,33,52,11],[55,34,52,12,"useContext"],[55,44,52,22],[55,45,52,23,"NavigationBuilderContext"],[55,71,52,23],[55,72,52,23,"NavigationBuilderContext"],[55,129,52,47],[55,130,52,48],[56,6,51,4,"addKeyedListener"],[56,22,51,20],[56,25,51,20,"_React$useContext"],[56,42,51,20],[56,43,51,4,"addKeyedListener"],[56,59,51,20],[57,4,53,2],[57,8,53,8,"route"],[57,13,53,13],[57,16,53,16,"React"],[57,21,53,21],[57,22,53,22,"useContext"],[57,32,53,32],[57,33,53,33,"NavigationRouteContext"],[57,59,53,33],[57,60,53,33,"NavigationRouteContext"],[57,113,53,55],[57,114,53,56],[58,4,54,2],[58,8,54,8,"routeKey"],[58,16,54,16],[58,19,54,19,"route"],[58,24,54,24],[58,26,54,26,"key"],[58,29,54,29],[59,4,55,2,"React"],[59,9,55,7],[59,10,55,8,"useEffect"],[59,19,55,17],[59,20,55,18],[59,26,55,24],[60,6,56,4],[60,10,56,8,"routeKey"],[60,18,56,16],[60,20,56,18],[61,8,57,6],[61,15,57,13,"addKeyedListener"],[61,31,57,29],[61,34,57,32],[61,48,57,46],[61,50,57,48,"routeKey"],[61,58,57,56],[61,60,57,58,"action"],[61,66,57,64],[61,70,57,68],[62,10,58,8],[62,14,58,14,"state"],[62,19,58,19],[62,22,58,22,"getState"],[62,30,58,30],[62,31,58,31],[62,32,58,32],[63,10,59,8],[63,17,59,15,"shouldPreventRemove"],[63,36,59,34],[63,37,59,35,"emitter"],[63,44,59,42],[63,46,59,44,"beforeRemoveListeners"],[63,67,59,65],[63,69,59,67,"state"],[63,74,59,72],[63,75,59,73,"routes"],[63,81,59,79],[63,83,59,81],[63,85,59,83],[63,87,59,85,"action"],[63,93,59,91],[63,94,59,92],[64,8,60,6],[64,9,60,7],[64,10,60,8],[65,6,61,4],[66,4,62,2],[66,5,62,3],[66,7,62,5],[66,8,62,6,"addKeyedListener"],[66,24,62,22],[66,26,62,24,"beforeRemoveListeners"],[66,47,62,45],[66,49,62,47,"emitter"],[66,56,62,54],[66,58,62,56,"getState"],[66,66,62,64],[66,68,62,66,"routeKey"],[66,76,62,74],[66,77,62,75],[66,78,62,76],[67,2,63,0],[68,0,63,1],[68,3]],"functionMap":{"names":["<global>","shouldPreventRemove","nextRoutes.map$argument_0","currentRoutes.filter$argument_0","useOnPreventRemove","React.useEffect$argument_0","addKeyedListener$argument_2"],"mappings":"AAA;mCCM;uCCC,kBD;6CEG,2CF;CDiC;OIC;kBCU;0DCE;ODG;GDE;CJC"}},"type":"js/module"}]}